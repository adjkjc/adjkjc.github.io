(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{"../node_modules/component-event/index.js":function(e,t){var n=window.addEventListener?"addEventListener":"attachEvent",s=window.removeEventListener?"removeEventListener":"detachEvent",r="addEventListener"!==n?"on":"";t.bind=function(e,t,s,a){return e[n](r+t,s,a||!1),s},t.unbind=function(e,t,n,a){return e[s](r+t,n,a||!1),n}},"../node_modules/component-file-picker/index.js":function(e,t,n){var s=n("../node_modules/component-event/index.js");e.exports=function(e,t){"function"==typeof e&&(t=e,e={});e=e||{},a.multiple=!!e.multiple,a.webkitdirectory=a.mozdirectory=a.directory=!!e.directory,null==e.accept?delete a.accept:e.accept.join?a.accept=e.accept.join(","):e.accept&&(a.accept=e.accept);o&&s.unbind(a,"change",o);function n(e){t(a.files,e,a),s.unbind(a,"change",n),o=!1}s.bind(a,"change",n),o=n,r.reset(),a.click()};var r=document.createElement("form");r.innerHTML='<input type="file" style="top: -1000px; position: absolute" aria-hidden="true">',document.body.appendChild(r);var a=r.childNodes[0],o=!1},"../node_modules/lodash-es/flowRight.js":function(e,t,n){"use strict";var s=n("../node_modules/lodash-es/_createFlow.js"),r=Object(s.a)(!0);t.a=r},"../node_modules/lodash-es/take.js":function(e,t,n){"use strict";var s=n("../node_modules/lodash-es/_baseSlice.js"),r=n("../node_modules/lodash-es/toInteger.js");t.a=function(e,t,n){return e&&e.length?(t=n||void 0===t?1:Object(r.a)(t),Object(s.a)(e,0,t<0?0:t)):[]}},"../packages/components/dist/esm/progress-bar/index.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/createSuper.js"),d=n.n(p),m=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=n.n(m),f=n("../node_modules/react/index.js"),g=n("../node_modules/classnames/index.js"),b=n.n(g),v=n("../packages/components/dist/esm/screen-reader-text/index.js"),y=(n("../packages/components/dist/esm/progress-bar/style.scss"),function(e){u()(n,e);var t=d()(n);function n(){var e;r()(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),h()(c()(e),"state",{allTimeMax:e.props.value}),e}return o()(n,[{key:"getCompletionPercentage",value:function(){var e=Math.ceil((this.props.canGoBackwards?this.props.value:this.state.allTimeMax)/this.props.total*100);return Math.min(e,100)}},{key:"renderBar",value:function(){var e=this.props,t=e.color,n=e.title,s=e.total,r=e.value,a={width:this.getCompletionPercentage()+"%"};return t&&(a.backgroundColor=t),f.createElement("div",{"aria-valuemax":s,"aria-valuemin":0,"aria-valuenow":r,className:"progress-bar__progress",role:"progressbar",style:a},n&&f.createElement(v.a,null,n))}},{key:"render",value:function(){var e=b()(this.props.className,"progress-bar",{"is-compact":this.props.compact,"is-pulsing":this.props.isPulsing});return f.createElement("div",{className:e},this.renderBar())}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{allTimeMax:Math.max(t.allTimeMax,e.value)}}}]),n}(f.PureComponent));h()(y,"defaultProps",{total:100,compact:!1,isPulsing:!1,canGoBackwards:!1})},"../packages/components/dist/esm/progress-bar/style.scss":function(e,t,n){},"./blocks/upload-drop-zone/index.jsx":function(e,t,n){"use strict";var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/createSuper.js"),d=n.n(p),m=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=n.n(m),f=n("../node_modules/prop-types/index.js"),g=n.n(f),b=n("../node_modules/react/index.js"),v=n.n(b),y=n("../node_modules/react-redux/es/index.js"),j=n("../packages/i18n-calypso/dist/esm/index.js"),k=n("./components/gridicon/index.tsx"),_=n("../node_modules/classnames/index.js"),O=n.n(_),w=n("./components/file-picker/index.jsx"),S=n("./components/drop-zone/index.jsx"),E=n("./state/ui/selectors/get-selected-site-id.js"),T=n("./notices/index.js"),x=n("../node_modules/debug/src/browser.js"),C=n.n(x),P=(n("./blocks/upload-drop-zone/style.scss"),C()("calypso:upload-drop-zone")),I=function(e){u()(n,e);var t=d()(n);function n(){var e;r()(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),h()(c()(e),"onFileSelect",(function(t){var n=e.props,s=n.translate,r=n.siteId,a=n.doUpload;if(1===t.length){var o=t[0]||t.item(0);P("zip file:",o),o.size>5e7?T.a.error(s("Zip file is too large. Please upload a file under 50 MB.")):a(r,o)}else T.a.error(s("Please drop a single zip file"))})),e}return o()(n,[{key:"render",value:function(){var e=this.props,t=e.translate,n=e.disabled,s=t("Drop files or click here to install"),r=t("Only single .zip files are accepted."),a=O()("upload-drop-zone",{"is-disabled":n});return v.a.createElement("div",{className:a},v.a.createElement("div",{className:"upload-drop-zone__dropzone"},v.a.createElement(S.a,{onFilesDrop:this.onFileSelect}),v.a.createElement(w.a,{accept:"application/zip",onPick:this.onFileSelect},v.a.createElement(k.a,{className:"upload-drop-zone__icon",icon:"cloud-upload",size:48}),s,v.a.createElement("span",{className:"upload-drop-zone__instructions"},r))))}}]),n}(b.Component);h()(I,"propTypes",{doUpload:g.a.func.isRequired,disabled:g.a.bool,siteId:g.a.number});t.a=Object(y.c)((function(e){return{siteId:Object(E.a)(e)}}))(Object(j.c)(I))},"./blocks/upload-drop-zone/style.scss":function(e,t,n){},"./blocks/upwork-banner/style.scss":function(e,t,n){},"./components/drop-zone/index.jsx":function(e,t,n){"use strict";var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/createSuper.js"),d=n.n(p),m=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=n.n(m),f=n("../node_modules/react-dom/index.js"),g=n.n(f),b=n("../node_modules/react/index.js"),v=n.n(b),y=n("../node_modules/prop-types/index.js"),j=n.n(y),k=n("../node_modules/react-redux/es/index.js"),_=n("../node_modules/classnames/index.js"),O=n.n(_),w=n("../packages/i18n-calypso/dist/esm/index.js"),S=n("../node_modules/lodash-es/without.js"),E=n("../node_modules/lodash-es/includes.js"),T=n("../node_modules/lodash-es/noop.js"),x=n("../node_modules/lodash-es/identity.js"),C=n("../packages/components/dist/esm/root-child/index.js"),P=n("./components/gridicon/index.tsx"),I=n("./state/action-types.js");var N=n("./components/translatable/proptype.js"),R=(n("./components/drop-zone/style.scss"),function(e){u()(n,e);var t=d()(n);function n(){var e;r()(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),h()(c()(e),"state",{isDraggingOverDocument:!1,isDraggingOverElement:!1,lastVisibleState:!1}),h()(c()(e),"zoneRef",v.a.createRef()),h()(c()(e),"resetDragState",(function(){(e.state.isDraggingOverDocument||e.state.isDraggingOverElement)&&(e.setState({isDraggingOverDocument:!1,isDraggingOverElement:!1}),e.toggleDropZoneReduxState(!1))})),h()(c()(e),"toggleMutationObserver",(function(){e.disconnectMutationObserver(),e.state.isDraggingOverDocument&&(e.observer=new window.MutationObserver(e.detectNodeRemoval),e.observer.observe(document.body,{childList:!0,subtree:!0}))})),h()(c()(e),"disconnectMutationObserver",(function(){e.observer&&(e.observer.disconnect(),delete e.observer)})),h()(c()(e),"detectNodeRemoval",(function(t){t.forEach((function(t){t.removedNodes.length&&(e.dragEnterNodes=Object(S.a)(e.dragEnterNodes,Array.from(t.removedNodes)))}))})),h()(c()(e),"toggleDraggingOverDocument",(function(t){"dragenter"!==t.type||Object(E.a)(e.dragEnterNodes,t.target)?"dragleave"===t.type&&(e.dragEnterNodes=Object(S.a)(e.dragEnterNodes,t.target)):e.dragEnterNodes.push(t.target);var n=window.CustomEvent&&t instanceof window.CustomEvent?t.detail:t,s=e.props.onVerifyValidTransfer(n.dataTransfer)&&e.dragEnterNodes.length;e.setState({isDraggingOverDocument:s,isDraggingOverElement:s&&(e.props.fullScreen||e.isWithinZoneBounds(n.clientX,n.clientY))}),window.CustomEvent&&t instanceof window.CustomEvent&&(e.dragEnterNodes=Object(S.a)(e.dragEnterNodes,window)),e.toggleDropZoneReduxState(!(!e.state.isDraggingOverDocument&&!e.state.isDraggingOverElement))})),h()(c()(e),"toggleDropZoneReduxState",(function(t){e.state.lastVisibleState!==t&&(t?e.props.showDropZone(e.props.dropZoneName):e.props.hideDropZone(e.props.dropZoneName),e.setState({lastVisibleState:t}))})),h()(c()(e),"preventDefault",(function(e){e.preventDefault()})),h()(c()(e),"isWithinZoneBounds",(function(t,n){if(!e.zoneRef.current)return!1;var s=e.zoneRef.current.getBoundingClientRect();return s.bottom!==s.top&&s.left!==s.right&&(t>=s.left&&t<=s.right&&n>=s.top&&n<=s.bottom)})),h()(c()(e),"onDrop",(function(t){t.dataTransfer&&t.dataTransfer.files.length,e.resetDragState(),t.preventDefault(),(e.props.fullScreen||g.a.findDOMNode(e.zoneRef.current).contains(t.target))&&(e.props.onDrop(t),e.props.onVerifyValidTransfer(t.dataTransfer)&&(t.dataTransfer&&e.props.onFilesDrop(Array.prototype.slice.call(t.dataTransfer.files)),t.stopPropagation()))})),h()(c()(e),"renderContent",(function(){var t=e.props.textLabel?e.props.textLabel:e.props.translate("Drop files to upload");return v.a.createElement("div",{className:"drop-zone__content"},e.props.children?e.props.children:v.a.createElement("div",null,v.a.createElement("span",{className:"drop-zone__content-icon"},e.props.icon),v.a.createElement("span",{className:"drop-zone__content-text"},t)))})),e}return o()(n,[{key:"componentDidMount",value:function(){this.dragEnterNodes=[],window.addEventListener("dragover",this.preventDefault),window.addEventListener("drop",this.onDrop),window.addEventListener("dragenter",this.toggleDraggingOverDocument),window.addEventListener("dragleave",this.toggleDraggingOverDocument),window.addEventListener("mouseup",this.resetDragState)}},{key:"componentDidUpdate",value:function(e,t){t.isDraggingOverDocument!==this.state.isDraggingOverDocument&&this.toggleMutationObserver()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("dragover",this.preventDefault),window.removeEventListener("drop",this.onDrop),window.removeEventListener("dragenter",this.toggleDraggingOverDocument),window.removeEventListener("dragleave",this.toggleDraggingOverDocument),window.removeEventListener("mouseup",this.resetDragState),this.disconnectMutationObserver()}},{key:"render",value:function(){var e=O()("drop-zone",this.props.className,{"is-active":this.state.isDraggingOverDocument||this.state.isDraggingOverElement,"is-dragging-over-document":this.state.isDraggingOverDocument,"is-dragging-over-element":this.state.isDraggingOverElement,"is-full-screen":this.props.fullScreen}),t=v.a.createElement("div",{ref:this.zoneRef,className:e},this.renderContent());return this.props.fullScreen?v.a.createElement(C.a,null,t):t}}]),n}(v.a.Component));h()(R,"propTypes",{className:j.a.string,fullScreen:j.a.bool,icon:j.a.node,onDrop:j.a.func,onVerifyValidTransfer:j.a.func,onFilesDrop:j.a.func,textLabel:N.a,translate:j.a.func,showDropZone:j.a.func.isRequired,hideDropZone:j.a.func.isRequired,dropZoneName:j.a.string}),h()(R,"defaultProps",{className:null,onDrop:T.a,onVerifyValidTransfer:function(){return!0},onFilesDrop:T.a,fullScreen:!1,icon:v.a.createElement(P.a,{icon:"cloud-upload",size:48}),translate:x.a,dropZoneName:null});var D={showDropZone:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:I.rd,dropZoneName:e}},hideDropZone:function(e){return{type:I.qd,dropZoneName:e}}};t.a=Object(k.c)(null,D)(Object(w.c)(R))},"./components/drop-zone/style.scss":function(e,t,n){},"./components/file-picker/index.jsx":function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/createSuper.js"),d=n.n(p),m=n("../node_modules/prop-types/index.js"),h=n.n(m),f=n("../node_modules/react/index.js"),g=n.n(f),b=n("../node_modules/lodash-es/assign.js"),v=n("../node_modules/lodash-es/noop.js"),y=n("../node_modules/component-file-picker/index.js"),j=n.n(y),k=function(e){u()(n,e);var t=d()(n);function n(e){var s;return r()(this,n),(s=t.call(this,e)).showPicker=s.showPicker.bind(c()(s)),s}return o()(n,[{key:"showPicker",value:function(){this.props.onClick(),j()(Object(b.a)({},this.props),this.props.onPick)}},{key:"render",value:function(){return g.a.createElement("span",{className:"file-picker",onClick:this.showPicker},this.props.children)}}]),n}(g.a.Component);k.displayName="FilePicker",k.propTypes={multiple:h.a.bool,directory:h.a.bool,accept:h.a.string,onClick:h.a.func,onPick:h.a.func},k.defaultProps={multiple:!1,directory:!1,accept:null,onClick:v.a,onPick:v.a}},"./components/infinite-scroll/index.js":function(e,t,n){"use strict";var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/createSuper.js"),d=n.n(p),m=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=n.n(m),f=n("../node_modules/react/index.js"),g=n.n(f),b=n("../node_modules/prop-types/index.js"),v=n.n(b),y=n("../node_modules/lodash-es/defer.js"),j=n("../node_modules/lodash-es/throttle.js"),k=n("./lib/after-layout-flush/index.ts"),_="undefined"!=typeof window&&"IntersectionObserver"in window,O={nextPageMethod:v.a.func.isRequired},w=function(e){u()(n,e);var t=d()(n);function n(){var e;r()(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),h()(c()(e),"observedElement",g.a.createRef()),h()(c()(e),"hasScrolledPastBottom",!1),h()(c()(e),"handleIntersection",(function(t){t&&t[0]&&(t[0].isIntersecting?e.getNextPage():e.hasScrolledPastBottom=!0)})),e}return o()(n,[{key:"componentDidMount",value:function(){this.observedElement.current&&(this.observer=new IntersectionObserver(this.handleIntersection,{rootMargin:"100%",threshold:1}),this.observer.observe(this.observedElement.current))}},{key:"componentWillUnmount",value:function(){this.observer&&this.observer.disconnect(),clearTimeout(this.deferredPageFetch)}},{key:"getNextPage",value:function(){this.props.nextPageMethod({triggeredByScroll:this.hasScrolledPastBottom})}},{key:"componentDidUpdate",value:function(){var e=this;this.deferredPageFetch||this.hasScrolledPastBottom||(this.deferredPageFetch=Object(y.a)((function(){e.hasScrolledPastBottom||e.getNextPage(),e.deferredPageFetch=null})))}},{key:"render",value:function(){return g.a.createElement("div",{ref:this.observedElement})}}]),n}(g.a.Component);h()(w,"propTypes",O),h()(w,"displayName","InfiniteScroll");var S=function(e){u()(n,e);var t=d()(n);function n(){var e;r()(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),h()(c()(e),"checkScrollPosition",(function(t){var n=window.pageYOffset,s=document.body.scrollHeight,r=window.innerHeight;n>=s-r-2*r&&(n>r&&(t=!0),e.props.nextPageMethod({triggeredByScroll:t}))})),h()(c()(e),"pendingLayoutFlush",Object(k.a)(e.checkScrollPosition)),h()(c()(e),"throttledCheckScrollPosition",Object(j.a)(e.pendingLayoutFlush,400)),h()(c()(e),"checkScrollPositionHandler",(function(){return e.throttledCheckScrollPosition(!0)})),e}return o()(n,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.checkScrollPositionHandler),this.throttledCheckScrollPosition(!1)}},{key:"componentDidUpdate",value:function(){this.throttledCheckScrollPosition(!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.checkScrollPositionHandler),this.throttledCheckScrollPosition.cancel(),this.pendingLayoutFlush.cancel()}},{key:"render",value:function(){return g.a.createElement("div",null)}}]),n}(g.a.Component);h()(S,"propTypes",O),h()(S,"displayName","InfiniteScroll"),t.a=_?w:S},"./components/keyed-suggestions/style.scss":function(e,t,n){},"./components/segmented-control/index.jsx":function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/inherits.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/createSuper.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),d=n.n(p),m=n("../node_modules/prop-types/index.js"),h=n.n(m),f=n("../node_modules/react/index.js"),g=n.n(f),b=n("../node_modules/classnames/index.js"),v=n.n(b),y=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),j=n.n(y),k=function(e){c()(n,e);var t=u()(n);function n(){var e;r()(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),d()(j()(e),"handleKeyEvent",(function(e){switch(e.keyCode){case 13:case 32:e.preventDefault(),document.activeElement.click()}})),e}return o()(n,[{key:"render",value:function(){var e=v()({"segmented-control__item":!0,"is-selected":this.props.selected}),t=v()("segmented-control__link",d()({},"item-index-".concat(this.props.index),null!=this.props.index));return g.a.createElement("li",{className:e},g.a.createElement("a",{href:this.props.path,className:t,onClick:this.props.onClick,title:this.props.title,"data-e2e-value":this.props.value,role:"radio",tabIndex:0,"aria-checked":this.props.selected,onKeyDown:this.handleKeyEvent},g.a.createElement("span",{className:"segmented-control__text"},this.props.children)))}}]),n}(g.a.Component);d()(k,"propTypes",{children:h.a.node.isRequired,path:h.a.string,selected:h.a.bool,title:h.a.string,value:h.a.string,onClick:h.a.func,index:h.a.number}),d()(k,"defaultProps",{selected:!1});var _=k,O=(n("./components/segmented-control/style.scss"),function(e){c()(n,e);var t=u()(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"render",value:function(){var e={"is-compact":this.props.compact,"is-primary":this.props.primary};return g.a.createElement("ul",{className:v()("segmented-control",e,this.props.className),style:this.props.style,role:"radiogroup"},this.props.children)}}]),n}(g.a.Component));d()(O,"Item",_),d()(O,"propTypes",{className:h.a.string,compact:h.a.bool,primary:h.a.bool,style:h.a.object,children:h.a.node.isRequired})},"./components/segmented-control/simplified.jsx":function(e,t,n){"use strict";var s=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),o=n.n(a),i=n("../node_modules/react/index.js"),c=n.n(i),l=n("../node_modules/prop-types/index.js"),u=n.n(l),p=n("../node_modules/lodash-es/noop.js"),d=n("./components/segmented-control/index.jsx");function m(e){var t=e.options,n=e.initialSelected,s=void 0===n?t[0].value:n,a=e.onSelect,l=void 0===a?p.a:a,u=o()(e,["options","initialSelected","onSelect"]),m=Object(i.useState)(s),h=r()(m,2),f=h[0],g=h[1],b=t.map((function(e,t){return c.a.createElement(d.a.Item,{index:t,key:t,onClick:function(){g(e.value),l(e)},path:e.path,selected:f===e.value,value:e.value},e.label)}));return c.a.createElement(d.a,u,b)}m.propTypes={className:u.a.string,compact:u.a.bool,primary:u.a.bool,style:u.a.object,initialSelected:u.a.string,onSelect:u.a.func,options:u.a.arrayOf(u.a.shape({value:u.a.string.isRequired,label:u.a.string.isRequired,path:u.a.string})).isRequired},t.a=m},"./components/segmented-control/style.scss":function(e,t,n){},"./components/sticky-panel/index.jsx":function(e,t,n){"use strict";var s=n("../node_modules/@babel/runtime/helpers/objectSpread2.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(p),m=n("../node_modules/@babel/runtime/helpers/createSuper.js"),h=n.n(m),f=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),g=n.n(f),b=n("../packages/viewport/dist/esm/index.js"),v=n("../node_modules/lodash-es/throttle.js"),y=n("../node_modules/lodash-es/defer.js"),j=n("../node_modules/prop-types/index.js"),k=n.n(j),_=n("../node_modules/react-dom/index.js"),O=n.n(_),w=n("../node_modules/react/index.js"),S=n.n(w),E=n("../node_modules/classnames/index.js"),T=n.n(E),x=n("./lib/after-layout-flush/index.ts"),C=(n("./components/sticky-panel/style.scss"),"undefined"!=typeof window&&"IntersectionObserver"in window),P={minLimit:k.a.oneOfType([k.a.bool,k.a.number])},I={minLimit:!1};function N(){return document.getElementById("header").getBoundingClientRect().height}function R(e){if(e.isSticky)return{top:N(),width:e.blockWidth}}function D(e,t){return{spacerHeight:t?O.a.findDOMNode(e).clientHeight:0,blockWidth:t?O.a.findDOMNode(e).clientWidth:0}}function U(e,t){var n=D(e,t.isSticky);return t.spacerHeight!==n.spacerHeight||t.blockWidth!==n.blockWidth?n:null}function A(e,t){var n=T()("sticky-panel",e.className,{"is-sticky":t.isSticky});return S.a.createElement("div",{className:n},S.a.createElement("div",{className:"sticky-panel__content",style:R(t)},e.children),S.a.createElement("div",{className:"sticky-panel__spacer",style:{height:t.spacerHeight}}))}function q(e){return!1!==e&&e>=window.innerWidth||Object(b.e)()}var L=function(e){d()(n,e);var t=h()(n);function n(){var e;o()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),g()(u()(e),"state",{isSticky:!1,spacerHeight:0,blockWidth:0}),g()(u()(e),"onIntersection",Object(x.a)((function(t){if(t&&t[0]){var n=t[0],s=n.intersectionRatio,r=n.rootBounds,a=n.boundingClientRect,o=s<1&&r.bottom>a.bottom;e.updateStickyState(o)}}))),g()(u()(e),"throttleOnResize",Object(v.a)((function(){return e.setState((function(t){return D(u()(e),t.isSticky)}))}),200)),e}return c()(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.throttleOnResize),this.deferredMount=Object(y.a)((function(){e.observer=new IntersectionObserver(e.onIntersection,{threshold:[0,1],rootMargin:"-".concat(N(),"px 0px 0px 0px")}),e.observer.observe(O.a.findDOMNode(e))}))}},{key:"componentWillUnmount",value:function(){this.observer&&this.observer.disconnect(),this.onIntersection.cancel(),clearTimeout(this.deferredMount),window.removeEventListener("resize",this.throttleOnResize)}},{key:"updateStickyState",value:function(e){if(q(this.props.minLimit))return this.setState({isSticky:!1});e!==this.state.isSticky&&this.setState(r()({isSticky:e},D(this,e)))}},{key:"render",value:function(){return A(this.props,this.state)}}]),n}(S.a.Component);g()(L,"displayName","StickyPanel"),g()(L,"propTypes",P),g()(L,"defaultProps",I);var z=function(e){d()(n,e);var t=h()(n);function n(){var e;o()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),g()(u()(e),"state",{isSticky:!1,spacerHeight:0,blockWidth:0}),g()(u()(e),"onWindowScroll",Object(x.a)((function(){var t=O.a.findDOMNode(u()(e)).getBoundingClientRect().top<N();e.updateStickyState(t)}))),g()(u()(e),"throttleOnResize",Object(v.a)((function(){return e.setState((function(t){return U(u()(e),t)}))}),200)),e}return c()(n,[{key:"componentDidMount",value:function(){this.onWindowScroll(),window.addEventListener("scroll",this.onWindowScroll),window.addEventListener("resize",this.throttleOnResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.onWindowScroll),window.removeEventListener("resize",this.throttleOnResize),this.onWindowScroll.cancel()}},{key:"updateStickyState",value:function(e){if(q(this.props.minLimit))return this.setState({isSticky:!1});e!==this.state.isSticky&&this.setState(r()({isSticky:e},D(this,e)))}},{key:"render",value:function(){return A(this.props,this.state)}}]),n}(S.a.Component);g()(z,"displayName","StickyPanel"),g()(z,"propTypes",P),g()(z,"defaultProps",I),t.a=C?L:z},"./components/sticky-panel/style.scss":function(e,t,n){},"./components/sub-masterbar-nav/style.scss":function(e,t,n){},"./components/themes-list/index.jsx":function(e,t,n){"use strict";var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/createSuper.js"),d=n.n(p),m=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=n.n(m),f=n("../node_modules/prop-types/index.js"),g=n.n(f),b=n("../node_modules/react/index.js"),v=n.n(b),y=n("../node_modules/react-redux/es/index.js"),j=n("../node_modules/lodash-es/isEqual.js"),k=n("../node_modules/lodash-es/isEmpty.js"),_=n("../node_modules/lodash-es/times.js"),O=n("../node_modules/lodash-es/noop.js"),w=n("../packages/i18n-calypso/dist/esm/index.js"),S=n("./components/theme/index.jsx"),E=n("./components/empty-content/index.jsx"),T=n("./components/infinite-scroll/index.js"),x=n("./state/themes/constants.js"),C=n("./state/themes/themes-ui/selectors.js"),P=(n("./components/themes-list/style.scss"),function(e){u()(n,e);var t=d()(n);function n(){var e;r()(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),h()(c()(e),"fetchNextPage",(function(t){e.props.fetchNextPage(t)})),e}return o()(n,[{key:"shouldComponentUpdate",value:function(e){return e.loading!==this.props.loading||!Object(j.a)(e.themes,this.props.themes)||e.getButtonOptions!==this.props.getButtonOptions||e.getScreenshotUrl!==this.props.getScreenshotUrl||e.onScreenshotClick!==this.props.onScreenshotClick||e.onMoreButtonClick!==this.props.onMoreButtonClick}},{key:"renderTheme",value:function(e,t){if(Object(k.a)(e))return null;var n=this.props.themesBookmark===e.id?this.props.bookmarkRef:null;return v.a.createElement(S.a,{key:"theme-"+e.id,buttonContents:this.props.getButtonOptions(e.id),screenshotClickUrl:this.props.getScreenshotUrl&&this.props.getScreenshotUrl(e.id),onScreenshotClick:this.props.onScreenshotClick,onMoreButtonClick:this.props.onMoreButtonClick,actionLabel:this.props.getActionLabel(e.id),index:t,theme:e,active:this.props.isActive(e.id),price:this.props.getPrice(e.id),installing:this.props.isInstalling(e.id),upsellUrl:this.props.upsellUrl,bookmarkRef:n})}},{key:"renderLoadingPlaceholders",value:function(){return Object(_.a)(this.props.placeholderCount,(function(e){return v.a.createElement(S.a,{key:"placeholder-"+e,theme:{id:"placeholder-"+e,name:"Loading…"},isPlaceholder:!0})}))}},{key:"renderTrailingItems",value:function(){return Object(_.a)(11,(function(e){return v.a.createElement("div",{className:"themes-list__spacer",key:"themes-list__spacer-"+e})}))}},{key:"renderEmpty",value:function(){return this.props.emptyContent||v.a.createElement(E.a,{illustration:"/calypso/images/illustrations/no-themes-drake.svg",title:this.props.translate("Sorry, no themes found."),line:this.props.translate("Try a different search or more filters?")})}},{key:"render",value:function(){return this.props.loading||0!==this.props.themes.length?v.a.createElement("div",{className:"themes-list"},this.props.themes.map(this.renderTheme,this),this.props.loading&&this.renderLoadingPlaceholders(),this.renderTrailingItems(),v.a.createElement(T.a,{nextPageMethod:this.fetchNextPage})):this.renderEmpty()}}]),n}(v.a.Component));h()(P,"propTypes",{themes:g.a.array.isRequired,emptyContent:g.a.element,loading:g.a.bool.isRequired,fetchNextPage:g.a.func.isRequired,getButtonOptions:g.a.func,getScreenshotUrl:g.a.func,onScreenshotClick:g.a.func.isRequired,onMoreButtonClick:g.a.func,getActionLabel:g.a.func,isActive:g.a.func,getPrice:g.a.func,isInstalling:g.a.func,translate:g.a.func,placeholderCount:g.a.number,bookmarkRef:g.a.oneOfType([g.a.func,g.a.shape({current:g.a.any})])}),h()(P,"defaultProps",{loading:!1,themes:[],fetchNextPage:O.a,placeholderCount:x.a.number,optionsGenerator:function(){return[]},getActionLabel:function(){return""},isActive:function(){return!1},getPrice:function(){return""},isInstalling:function(){return!1}});t.a=Object(y.c)((function(e){return{themesBookmark:Object(C.b)(e)}}))(Object(w.c)(P))},"./components/themes-list/style.scss":function(e,t,n){},"./components/wpadmin-auto-login/index.jsx":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/inherits.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/createSuper.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),d=n.n(p),m=n("../node_modules/prop-types/index.js"),h=n.n(m),f=n("../node_modules/react/index.js"),g=n("../node_modules/lodash-es/get.js");function b(e,t,n){var s=new Image;n<9&&(s.onerror=function(){setTimeout(b.bind(null,e,t,n+1),t*n)}),s.src=e}var v=function(e){c()(n,e);var t=u()(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"componentDidMount",value:function(){var e=Object(g.a)(this.props.site,"URL"),t=this.getPixelUrl(e);setTimeout(b.bind(null,t,this.props.delay,0),this.props.delay)}},{key:"getPixelUrl",value:function(e){var t=encodeURI("".concat(e,"/wp-includes/images/blank.gif"));return"".concat(e,"/wp-login.php?redirect_to=").concat(t)}},{key:"render",value:function(){return null}}]),n}(f.Component);d()(v,"propTypes",{site:h.a.object,delay:h.a.number}),d()(v,"defaultProps",{delay:3e3})},"./lib/after-layout-flush/index.ts":function(e,t,n){"use strict";function s(e){var t,n,s,r,a=void 0,o=void 0,i="function"==typeof requestAnimationFrame,c=(s=e,function(){if(!i){t=this;for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];n=r}void 0===a&&(a=setTimeout((function(){var e=void 0!==n?n:[],r=t;n=void 0,t=void 0,a=void 0,s.apply(r,e)}),0))});i&&(r=c,c=function(){t=this;for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];n=s,void 0===o&&(o=requestAnimationFrame((function(){o=void 0,r()})))});var l=c;return l.cancel=function(){t=void 0,n=void 0,void 0!==o&&(cancelAnimationFrame(o),o=void 0),void 0!==a&&(clearTimeout(a),a=void 0)},l}n.d(t,"a",(function(){return s}))},"./lib/build-url/index.ts":function(e,t,n){"use strict";function s(e,t){var n=new URL(e,"http://dummy.example");return t?n.searchParams.set("s",t):n.searchParams.delete("s"),"".concat(n.pathname).concat(n.search).concat(n.hash).replace(/%20/g,"+")}n.d(t,"a",(function(){return s}))},"./my-sites/feature-upsell/redirect-if.jsx":function(e,t,n){"use strict";var s=n("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/createSuper.js"),d=n.n(p),m=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=n.n(m),f=n("../node_modules/react/index.js"),g=n.n(f),b=n("../node_modules/prop-types/index.js"),v=n.n(b),y=n("../node_modules/react-redux/es/index.js"),j=n("../node_modules/page/page.js"),k=n.n(j),_=n("./state/ui/selectors/get-selected-site-id.js"),O=n("./state/sites/plans/selectors.js"),w=n("./state/sites/selectors/get-site-slug.js"),S=function(e){u()(n,e);var t=d()(n);function n(){return o()(this,n),t.apply(this,arguments)}return c()(n,[{key:"componentDidMount",value:function(){this.redirected=!1,this.goToUpsellPageIfRequired()}},{key:"componentDidUpdate",value:function(){this.goToUpsellPageIfRequired()}},{key:"goToUpsellPageIfRequired",value:function(){var e=this.props;this.shouldRedirect()&&(this.redirected||(setTimeout((function(){k.a.redirect("".concat(e.upsellPageURL,"/").concat(e.siteSlug))})),this.redirected=!0))}},{key:"shouldRedirect",value:function(){var e=this.props;return e.shouldRedirect&&!e.loadingPlan}},{key:"render",value:function(){var e=this.props,t=e.ComponentClass,n=e.loadingPlan,s=(e.shouldRedirect,r()(e,["ComponentClass","loadingPlan","shouldRedirect"]));return!n&&!this.shouldRedirect()&&g.a.createElement(t,s)}}]),n}(g.a.Component);h()(S,"propTypes",{siteId:v.a.number.isRequired,ComponentClass:v.a.any.isRequired,upsellPageURL:v.a.string.isRequired,shouldRedirect:v.a.bool.isRequired,loadingPlan:v.a.bool.isRequired});t.a=function(e,t){return function(n){var s=function(e,t,n){return function(s){var r=Object(_.a)(s),a=Object(w.a)(s,r),o=Object(O.a)(s,r),i=!!(o&&a&&t(s,r));return{siteId:r,siteSlug:a,ComponentClass:e,upsellPageURL:n,shouldRedirect:i,loadingPlan:!o}}}(n,e,t);return Object(y.c)(s)(S)}}},"./my-sites/jetpack-manage-error-page/index.jsx":function(e,t,n){"use strict";var s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/createClass.js"),o=n.n(a),i=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=n.n(i),l=n("../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(l),p=n("../node_modules/@babel/runtime/helpers/createSuper.js"),d=n.n(p),m=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=n.n(m),f=n("../node_modules/react/index.js"),g=n.n(f),b=n("../node_modules/react-redux/es/index.js"),v=n("../packages/i18n-calypso/dist/esm/index.js"),y=n("./lib/analytics/ga.js"),j=n("./components/empty-content/index.jsx"),k=n("./components/feature-example/index.jsx"),_=n("./state/sites/selectors/get-site-slug.js"),O=function(e){u()(n,e);var t=d()(n);function n(){var e;r()(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),h()(c()(e),"actionCallbackUpdate",(function(){Object(y.a)("Jetpack","Update jetpack","Site",e.props.siteId)})),e}return o()(n,[{key:"getSettings",value:function(){var e=this.props,t=e.siteSlug,n=e.template,s=e.translate,r=this.props.version||"3.4",a={updateJetpack:{title:s("Your version of Jetpack is out of date."),line:s("Jetpack %(version)s or higher is required to see this page.",{args:{version:r}}),action:s("Update Jetpack"),illustration:null,actionURL:"../../plugins/jetpack/"+t,version:r},noDomainsOnJetpack:{title:s("Domains are not available for this site."),line:s("You can only purchase domains for sites hosted on WordPress.com at this time."),action:s("View Plans"),actionURL:"/plans/"+(t||"")},default:{}};return Object.assign({},a[n]||a.default,this.props)}},{key:"render",value:function(){var e=this.getSettings();n.actionCallbacks[this.props.template]&&(e.actionCallback=this[n.actionCallbacks[this.props.template]]);var t=this.props.featureExample?g.a.createElement(k.a,null,this.props.featureExample):null;return g.a.createElement("div",null,g.a.createElement(j.a,e),t)}}]),n}(f.PureComponent);h()(O,"actionCallbacks",{updateJetpack:"actionCallbackUpdate"}),t.a=Object(b.c)((function(e,t){var n=t.siteId;return{siteSlug:Object(_.a)(e,n)}}))(Object(v.c)(O))},"./my-sites/themes/current-theme/style.scss":function(e,t,n){},"./my-sites/themes/index.web.js":function(e,t,n){"use strict";n.r(t);var s=n("./lib/user/index.js"),r=n("./controller/index.web.js"),a=n("./my-sites/controller.js"),o=n("../node_modules/lodash-es/startsWith.js"),i=n("../node_modules/lodash-es/isEmpty.js"),c=n("../node_modules/lodash-es/compact.js"),l=n("../node_modules/lodash-es/includes.js"),u=n("../node_modules/debug/src/browser.js"),p=n.n(u),d=n("../node_modules/react/index.js"),m=n.n(d),h=n("../node_modules/@babel/runtime/helpers/extends.js"),f=n.n(h),g=n("../node_modules/react-redux/es/index.js"),b=n("../packages/i18n-calypso/dist/esm/index.js"),v=n("./components/main/index.jsx"),y=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),j=n.n(y),k=n("../node_modules/@babel/runtime/helpers/createClass.js"),_=n.n(k),O=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),w=n.n(O),S=n("../node_modules/@babel/runtime/helpers/inherits.js"),E=n.n(S),T=n("../node_modules/@babel/runtime/helpers/createSuper.js"),x=n.n(T),C=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),P=n.n(C),I=n("../node_modules/prop-types/index.js"),N=n.n(I),R=n("../node_modules/classnames/index.js"),D=n.n(R),U=n("../node_modules/lodash-es/pickBy.js"),A=n("../node_modules/lodash-es/map.js"),q=n("../packages/components/dist/esm/card/index.js"),L=n("./components/gridicon/index.tsx"),z=function(e){E()(n,e);var t=x()(n);function n(){return j()(this,n),t.apply(this,arguments)}return _()(n,[{key:"render",value:function(){return m.a.createElement("a",{role:"button",className:D()("current-theme__button","current-theme__"+this.props.name,{disabled:!this.props.href}),onClick:this.props.onClick.bind(null,this.props.name),href:this.props.href},m.a.createElement(L.a,{icon:this.props.icon,size:18}),m.a.createElement("span",{className:"current-theme__button-label"},this.props.label))}}]),n}(m.a.Component);P()(z,"displayName","CurrentThemeButton"),P()(z,"propTypes",{name:N.a.string.isRequired,label:N.a.string.isRequired,icon:N.a.string.isRequired,href:N.a.string,onClick:N.a.func});var M=n("./my-sites/themes/theme-options.js"),B=n("./my-sites/themes/helpers.js"),W=n("./state/themes/selectors/get-active-theme.js"),F=n("./state/themes/selectors/get-canonical-theme.js"),V=n("./components/data/query-active-theme/index.jsx"),J=n("./components/data/query-canonical-theme/index.jsx"),H=(n("./my-sites/themes/current-theme/style.scss"),function(e){E()(n,e);var t=x()(n);function n(){var e;j()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),P()(w()(e),"trackClick",(function(e){return Object(B.c)("current theme",e)})),e}return _()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentTheme,s=t.currentThemeId,r=t.siteId,a=t.translate,o=m.a.createElement("span",{className:"current-theme__placeholder"},"loading..."),i=n&&n.name?n.name:o,c=Object(U.a)(this.props.options,(function(e){return e.icon&&!(e.hideForTheme&&e.hideForTheme(s,r))})),l=n&&n.screenshot,u=!n;return m.a.createElement(q.a,{className:"current-theme"},m.a.createElement(V.a,{siteId:r}),s&&m.a.createElement(J.a,{themeId:s,siteId:r}),m.a.createElement("div",{className:"current-theme__current"},u&&m.a.createElement("div",{className:"current-theme__img-placeholder"}),l&&m.a.createElement("img",{src:n.screenshot+"?w=150",className:"current-theme__img",alt:""}),m.a.createElement("span",{className:"current-theme__label"},a("Current Theme")),m.a.createElement("span",{className:"current-theme__name"},i)),m.a.createElement("div",{className:D()("current-theme__actions",{"two-buttons":2===Object.keys(c).length})},Object(A.a)(c,(function(t,n){return m.a.createElement(z,{name:n,key:n,label:t.label,icon:t.icon,href:s&&t.getUrl(s),onClick:e.trackClick})}))))}}]),n}(d.Component));P()(H,"propTypes",{options:N.a.objectOf(N.a.shape({label:N.a.string,icon:N.a.string,getUrl:N.a.func})),siteId:N.a.number.isRequired,currentTheme:N.a.object});var Z=Object(M.a)(Object(b.c)(H)),K=Object(g.c)((function(e,t){var n=t.siteId,s=Object(W.a)(e,n);return{currentThemeId:s,currentTheme:Object(F.a)(e,n,s)}}))((function(e){var t=e.siteId,n=e.currentTheme,s=e.currentThemeId;return m.a.createElement(Z,{currentTheme:n,currentThemeId:s,siteId:t,source:"current theme"})})),G=n("./my-sites/sidebar-navigation/index.jsx"),Y=n("./components/formatted-header/index.jsx"),$=n("./my-sites/themes/thanks-modal.jsx"),Q=n("./my-sites/themes/auto-loading-homepage-modal.jsx"),X=n("./blocks/upsell-nudge/index.jsx"),ee=n("./lib/plans/constants.js"),te=n("./state/sites/plans/selectors.js"),ne=n("./components/data/query-site-plans/index.jsx"),se=n("./components/data/query-site-purchases/index.jsx"),re=n("../node_modules/@babel/runtime/helpers/objectSpread2.js"),ae=n.n(re),oe=n("../node_modules/page/page.js"),ie=n.n(oe),ce=n("./lib/abtest/index.js"),le=n("../packages/components/dist/esm/button/index.js"),ue=n("../node_modules/lodash-es/property.js"),pe=n("../node_modules/lodash-es/snakeCase.js"),de=n("../node_modules/lodash-es/isEqual.js"),me=n("./lib/wp/browser.js"),he=n("./lib/wporg/index.js"),fe=n("./state/themes/action-types.js"),ge=n("./state/analytics/actions/record.js"),be=n("./state/themes/actions/receive-themes.js"),ve=n("./state/themes/selectors/prepend-theme-filter-keys.js"),ye=n("./state/themes/utils.js");n("./state/themes/init.js");function je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n,s){var r=(new Date).getTime();return n({type:fe.i,siteId:e,query:t}),("wporg"===e?function(){return Object(he.d)(t)}:"wpcom"===e?function(){return me.a.undocumented().themes(null,ae()({},t,{apiVersion:"1.2"}))}:function(){return me.a.undocumented().themes(e,ae()({},t,{apiVersion:"1"}))})().then((function(a){var o,i=a.themes,c=a.info,l=(c=void 0===c?{}:c).results,u=a.found,p=void 0===u?l:u;if(o="wporg"===e?Object(A.a)(i,ye.j):"wpcom"===e?Object(A.a)(i,ye.i):Object(A.a)(i,ye.h),(t.search||t.filter)&&1===t.page){var d=(new Date).getTime()-r,m=Object(ve.a)(s(),t.filter),h=m+(t.search||""),f=Object(ge.e)("calypso_themeshowcase_search",{search_term:h||null,search_taxonomies:m,tier:t.tier,response_time_in_ms:d,result_count:p,results_first_page:o.map(Object(ue.a)("id")).join()});n(f)}n(Object(be.a)(o,e,t,p))})).catch((function(s){n({type:fe.j,siteId:e,query:t,error:s})}))}}var ke=n("../node_modules/lodash-es/uniq.js"),_e=n("./lib/create-selector/index.js"),Oe=Object(_e.a)((function(e,t,n){var s=e.themes.queries[t];if(!s)return null;var r=s.getItems(n);return r?Object(l.a)(r,void 0)?null:Object(ke.a)(r):null}),(function(e){return e.themes.queries}),(function(e,t,n){return Object(ye.a)(n,t)}));function we(e,t,n){var s=Object(ye.a)(n,t);return!!e.themes.queryRequests[s]}var Se=function(e){E()(n,e);var t=x()(n);function n(){return j()(this,n),t.apply(this,arguments)}return _()(n,[{key:"componentDidMount",value:function(){this.request()}},{key:"shouldComponentUpdate",value:function(e){return this.props.siteId!==e.siteId||!Object(de.a)(this.props.query,e.query)}},{key:"componentDidUpdate",value:function(){this.request()}},{key:"request",value:function(){this.props.isRequesting||this.props.hasThemes||this.props.requestThemes(this.props.siteId,this.props.query)}},{key:"render",value:function(){return null}}]),n}(d.Component);P()(Se,"propTypes",{siteId:N.a.oneOfType([N.a.number,N.a.oneOf(["wpcom","wporg"])]).isRequired,query:N.a.shape({search:N.a.string,tier:N.a.oneOf(["","free","premium"]),filter:N.a.string,page:N.a.number,number:N.a.number}),hasThemes:N.a.bool.isRequired,isRequesting:N.a.bool.isRequired,requestThemes:N.a.func.isRequired});var Ee=Object(g.c)((function(e,t){var n=t.query,s=t.siteId;return{hasThemes:!Object(i.a)(Oe(e,s,n)),isRequesting:we(e,s,n)}}),{requestThemes:je})(Se),Te=n("./components/themes-list/index.jsx"),xe=n("./state/sites/selectors/is-jetpack-site.js"),Ce=n("./state/sites/selectors/get-site-slug.js"),Pe=n("./state/current-user/selectors.js"),Ie=n("./state/themes/selectors/is-theme-active.js"),Ne=n("./state/themes/selectors/is-installing-theme.js"),Re=(n("./state/themes/selectors/get-premium-theme-price.js"),n("../node_modules/lodash-es/flatMap.js")),De=Object(_e.a)((function(e,t,n){var s=e.themes.queries[t];if(!s)return null;var r=s.getItemsIgnoringPage(n);if(!r)return null;if(!(n.search||n.filter||n.tier)){var a=e.themes.recommendedThemes.themes,o=Object(Re.a)(a,(function(e){return e.id}));r=r.filter((function(e){return!o.includes(e.id)}))}return Object(ke.a)(r)}),(function(e){return e.themes.queries}),(function(e,t,n){return Object(ye.b)(n,t)}));function Ue(e,t,n){var s;return e.themes.queries[t]?null===(s=e.themes.queries[t])||void 0===s?void 0:s.getFound(n):null}var Ae=n("./state/themes/constants.js");function qe(e,t,n){var s;if(!e.themes.queries[t])return null;var r=null===(s=e.themes.queries[t])||void 0===s?void 0:s.getNumberOfPages(n);return null===r?null:Object(xe.a)(e,t)?1:Math.max(r,1)}var Le={};function ze(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Le,s=qe(e,t,n);return null===s?s:s===(n.page||Ae.a.page)}var Me=n("./state/themes/actions/set-theme-preview-options.js"),Be=n("./config/index.js"),We=(n("./my-sites/themes/themes-selection.scss"),function(e){E()(n,e);var t=x()(n);function n(){var e;j()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),P()(w()(e),"recordSearchResultsClick",(function(t,n,s){var r=e.props,a=r.query,o=r.filterString,i=e.props.recommendedThemes||e.props.themes,c=o,l=c+(a.search||"");e.props.recordTracksEvent("calypso_themeshowcase_theme_click",{search_term:l||null,search_taxonomies:c,theme:t,results_rank:n+1,results:i.map(Object(ue.a)("id")).join(),page_number:a.page,theme_on_page:parseInt((n+1)/a.number),action:Object(pe.a)(s)})})),P()(w()(e),"onScreenshotClick",(function(t,n){Object(B.c)("theme","screenshot"),e.props.isThemeActive(t)||e.recordSearchResultsClick(t,n,"screenshot_info"),e.props.onScreenshotClick&&e.props.onScreenshotClick(t)})),P()(w()(e),"fetchNextPage",(function(t){e.props.isRequesting||e.props.isLastPage||(t.triggeredByScroll&&e.trackScrollPage(),e.props.recommendedThemes||e.props.incrementPage())})),P()(w()(e),"getOptions",(function(t){var n,s,r,a=e.props.getOptions(t);return a&&a.preview&&(a.preview.action=(n=a.preview.action,r=e.props.secondaryOption,function(o){return e.props.isLoggedIn?e.props.isThemeActive(t)?s=a.customize:a.purchase?s=a.purchase:a.upgradePlan?(s=a.upgradePlan,r=null):s=a.activate:(s=a.signup,r=null),e.props.setThemePreviewOptions(s,r),n(o)})),a})),e}return _()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.query;e.recommendedThemes||t.search||t.filter||t.tier||this.props.incrementPage()}},{key:"trackScrollPage",value:function(){this.props.recordTracksEvent("calypso_themeshowcase_scroll"),this.props.trackScrollPage()}},{key:"trackLastPage",value:function(){this.props.recordGoogleEvent("Themes","Reached Last Page"),this.props.recordTracksEvent("calypso_themeshowcase_last_page_scroll")}},{key:"render",value:function(){var e=this.props,t=e.source,n=e.query,s=e.upsellUrl;return m.a.createElement("div",{className:"themes__selection"},m.a.createElement(Ee,{query:n,siteId:t}),m.a.createElement(Te.a,{upsellUrl:s,themes:this.props.recommendedThemes||this.props.themes,fetchNextPage:this.fetchNextPage,onMoreButtonClick:this.recordSearchResultsClick,getButtonOptions:this.getOptions,onScreenshotClick:this.onScreenshotClick,getScreenshotUrl:this.props.getScreenshotUrl,getActionLabel:this.props.getActionLabel,isActive:this.props.isThemeActive,getPrice:this.props.getPremiumThemePrice,isInstalling:this.props.isInstallingTheme,loading:this.props.isRequesting,emptyContent:this.props.emptyContent,placeholderCount:this.props.placeholderCount,bookmarkRef:this.props.bookmarkRef}))}}]),n}(d.Component));function Fe(e,t){return function(n){return Object(Ie.a)(e,n,t)}}function Ve(e,t){return function(n){return Object(Ne.a)(e,n,t)}}P()(We,"propTypes",{emptyContent:N.a.element,query:N.a.object.isRequired,siteId:N.a.number,onScreenshotClick:N.a.func,getOptions:N.a.func,getActionLabel:N.a.func,incrementPage:N.a.func,source:N.a.oneOfType([N.a.number,N.a.oneOf(["wpcom","wporg"])]),themes:N.a.array,recommendedThemes:N.a.array,themesCount:N.a.number,isRequesting:N.a.bool,isLastPage:N.a.bool,isThemeActive:N.a.func,getPremiumThemePrice:N.a.func,isInstallingTheme:N.a.func,placeholderCount:N.a.number,bookmarkRef:N.a.oneOfType([N.a.func,N.a.shape({current:N.a.any})])}),P()(We,"defaultProps",{emptyContent:null,showUploadButton:!0});var Je=Object(g.c)((function(e,t){var n,s=t.filter,r=t.page,a=t.search,o=t.tier,i=t.vertical,u=t.siteId,p=t.source,d=Object(xe.a)(e,u);n="wpcom"===p||"wporg"===p?p:u&&d?u:"wpcom";var m=Object(l.a)(["wpcom","wporg"],n)?20:2e3,h={search:a,page:r,tier:Be.a.isEnabled("upgrades/premium-themes")?o:"free",filter:Object(c.a)([s,i]).join(","),number:m};return{query:h,source:n,siteSlug:Object(Ce.a)(e,u),themes:De(e,n,h)||[],themesCount:Ue(e,n,h),isRequesting:we(e,n,h),isLastPage:ze(e,n,h),isLoggedIn:!!Object(Pe.g)(e),isThemeActive:Fe(e,u),isInstallingTheme:Ve(e,u),getPremiumThemePrice:void 0,filterString:Object(ve.a)(e,h.filter)}}),{setThemePreviewOptions:Me.a,recordGoogleEvent:ge.c,recordTracksEvent:ge.e})(We),He=function(e){E()(n,e);var t=x()(n);function n(){var e;j()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),P()(w()(e),"state",{page:1}),P()(w()(e),"incrementPage",(function(){e.setState({page:e.state.page+1})})),P()(w()(e),"resetPage",(function(){e.setState({page:1})})),e}return _()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.search===this.props.search&&e.tier===this.props.tier&&Object(de.a)(e.filter,this.props.filter)&&Object(de.a)(e.vertical,this.props.vertical)||this.resetPage()}},{key:"render",value:function(){return m.a.createElement(Je,f()({},this.props,{page:this.state.page,incrementPage:this.incrementPage}))}}]),n}(m.a.Component),Ze=n("../node_modules/lodash-es/find.js"),Ke=n("../node_modules/react-dom/index.js"),Ge=n("../node_modules/lodash-es/noop.js"),Ye=function(e){var t=e.isSelected,n=e.onClick,s=e.label,r=e.icon,a=e.href,o=D()("sub-masterbar-nav__item",{"is-selected":t});return m.a.createElement("a",{href:a,className:o,onClick:n,"aria-selected":t,role:"menuitem"},m.a.createElement(L.a,{className:"sub-masterbar-nav__icon",icon:r,size:24}),m.a.createElement("div",{className:"sub-masterbar-nav__label"},s))};Ye.propTypes={isSelected:N.a.bool,onClick:N.a.func,label:N.a.string.isRequired,icon:N.a.string,href:N.a.string},Ye.defaultProps={isSelected:!1,onClick:Ge.a,icon:"star"};var $e=Ye,Qe=N.a.shape({label:N.a.string.isRequired,uri:N.a.string.isRequired,icon:N.a.string}),Xe=function(e){E()(n,e);var t=x()(n);function n(){var e;j()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),P()(w()(e),"state",{collapsed:!0,foldable:!1}),P()(w()(e),"renderItem",(function(t,n){return m.a.createElement($e,{key:n,isSelected:t===e.props.selected,label:t.label,icon:t.icon,href:t.uri})})),P()(w()(e),"toggleList",(function(){e.setState((function(e){return{collapsed:!e.collapsed}}))})),P()(w()(e),"onResize",(function(){var t=Object(Ke.findDOMNode)(w()(e)).offsetWidth;e.setState((function(e,n){return{foldable:t<110*n.options.length+50}}))})),e}return _()(n,[{key:"componentDidMount",value:function(){this.onResize(),window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"render",value:function(){var e=D()("sub-masterbar-nav__navbar",{"is-collapsed":this.state.collapsed}),t=D()("sub-masterbar-nav__ellipsis",{"is-open":!this.state.collapsed});return m.a.createElement("div",{className:e},m.a.createElement("div",{className:"sub-masterbar-nav__wrapper"},m.a.createElement("div",{className:"sub-masterbar-nav__items"},this.props.options.map(this.renderItem))),this.state.foldable&&m.a.createElement("div",{className:"sub-masterbar-nav__switch"},m.a.createElement(L.a,{icon:"ellipsis",className:t,onClick:this.toggleList})))}}]),n}(d.Component);P()(Xe,"propTypes",{selected:Qe,options:N.a.arrayOf(Qe)});var et=N.a.shape({label:N.a.string.isRequired,uri:N.a.string.isRequired,icon:N.a.string}),tt=function(e){E()(n,e);var t=x()(n);function n(){var e;j()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),P()(w()(e),"state",{collapsed:!0}),P()(w()(e),"renderItem",(function(t,n){return m.a.createElement($e,{key:n,onClick:e.collapse,label:t.label,icon:t.icon,href:t.uri})})),P()(w()(e),"toggle",(function(){e.setState((function(e){return{collapsed:!e.collapsed}}))})),P()(w()(e),"collapse",(function(){e.setState((function(){return{collapsed:!0}}))})),e}return _()(n,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.collapse)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.collapse)}},{key:"render",value:function(){var e=D()("sub-masterbar-nav__dropdown",{"is-collapsed":this.state.collapsed});return m.a.createElement("div",{className:e},m.a.createElement("div",{className:"sub-masterbar-nav__select",onClick:this.toggle},m.a.createElement($e,{isSelected:!0,label:this.props.selected.label,icon:this.props.selected.icon}),m.a.createElement(L.a,{icon:"chevron-down",className:"sub-masterbar-nav__select-icon"})),m.a.createElement("div",{className:"sub-masterbar-nav__wrapper"},m.a.createElement("div",{className:"sub-masterbar-nav__items"},this.props.options.map(this.renderItem))))}}]),n}(d.Component);P()(tt,"propTypes",{selected:et,options:N.a.arrayOf(et)});n("./components/sub-masterbar-nav/style.scss");var nt=N.a.shape({label:N.a.string.isRequired,uri:N.a.string.isRequired,icon:N.a.string}),st=function(e){E()(n,e);var t=x()(n);function n(){return j()(this,n),t.apply(this,arguments)}return _()(n,[{key:"render",value:function(){return m.a.createElement("div",{className:"sub-masterbar-nav"},m.a.createElement(tt,{selected:this.getSelected()||this.props.fallback,options:this.props.options}),m.a.createElement(Xe,{selected:this.getSelected(),options:this.props.options}))}},{key:"getSelected",value:function(){var e=this;return Object(Ze.a)(this.props.options,(function(t){return t.uri===e.props.uri}))}}]),n}(d.Component);P()(st,"propTypes",{fallback:nt,options:N.a.arrayOf(nt),uri:N.a.string.isRequired}),P()(st,"defaultProps",{options:[]});var rt=n("./lib/analytics/page-view-tracker/index.jsx"),at=n("./components/data/document-head/index.jsx"),ot=n("./lib/build-url/index.ts"),it=n("./my-sites/themes/theme-preview.jsx"),ct=n("./state/themes/themes-ui/actions.js"),lt=n("./state/themes/themes-ui/selectors.js"),ut=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),pt=n.n(ut),dt=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),mt=n.n(dt),ht=n("../packages/viewport-react/dist/esm/index.js"),ft=n("../node_modules/react-click-outside/dist/index.js"),gt=n.n(ft),bt=n("../node_modules/lodash-es/intersection.js"),vt=n("../node_modules/lodash-es/difference.js"),yt=n("../node_modules/lodash-es/flowRight.js"),jt=n("./components/search/index.jsx"),kt=n("./components/segmented-control/simplified.jsx"),_t=n("../node_modules/lodash-es/negate.js"),Ot=n("../node_modules/lodash-es/has.js"),wt=n("../node_modules/lodash-es/pick.js"),St=n("../node_modules/lodash-es/filter.js"),Et=n("../node_modules/lodash-es/without.js"),Tt=n("../node_modules/lodash-es/take.js"),xt=n("../node_modules/lodash-es/partition.js"),Ct=n("../node_modules/lodash-es/sortBy.js");n("./components/keyed-suggestions/style.scss");function Pt(e){return m.a.createElement("button",{className:"keyed-suggestions__category-show-all",onClick:function(){return e.onClick(e.category)}},e.label)}var It=function(e){E()(n,e);var t=x()(n);function n(){var e;j()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),P()(w()(e),"state",{suggestionPosition:0,currentSuggestion:null,suggestions:{},filterTerm:"",showAll:""}),P()(w()(e),"setInitialState",(function(t){var n=e.narrowDownAndSort(t,e.state.showAll),s=e.createTaxonomySuggestionsArray(n);e.setState({suggestions:n,taxonomySuggestionsArray:s,suggestionPosition:0,currentSuggestion:s[0]})})),P()(w()(e),"countSuggestions",(function(){return e.state.taxonomySuggestionsArray.length})),P()(w()(e),"getSuggestionForPosition",(function(t){return e.state.taxonomySuggestionsArray[t]})),P()(w()(e),"getPositionForSuggestion",(function(t){return e.state.taxonomySuggestionsArray.indexOf(t)})),P()(w()(e),"incPosition",(function(){var t=(e.state.suggestionPosition+1)%e.countSuggestions();e.setState({suggestionPosition:t,currentSuggestion:e.getSuggestionForPosition(t)})})),P()(w()(e),"decPosition",(function(){var t=e.state.suggestionPosition-1;e.setState({suggestionPosition:t<0?e.countSuggestions()-1:t,currentSuggestion:e.getSuggestionForPosition(t)})})),P()(w()(e),"handleKeyEvent",(function(t){switch(t.key){case"ArrowDown":e.incPosition(),t.preventDefault();break;case"ArrowUp":e.decPosition(),t.preventDefault();break;case"Enter":if(e.state.currentSuggestion)return e.props.suggest(e.state.currentSuggestion),!0}return!1})),P()(w()(e),"onMouseDown",(function(t){t.stopPropagation(),t.preventDefault();var n=t.currentTarget.textContent.split(" ")[0];e.props.suggest(n)})),P()(w()(e),"onMouseOver",(function(t){var n=t.currentTarget.textContent.split(" ")[0];e.setState({suggestionPosition:e.getPositionForSuggestion(n),currentSuggestion:n})})),P()(w()(e),"removeEmptySuggestions",(function(e){return Object(U.a)(e,Object(_t.a)(i.a))})),P()(w()(e),"narrowDownAndSort",(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=e.props.terms,r=t.split(":"),a=mt()(r,2),o=a[0],i=a[1];if(""===o)return{};var c,u,p=3;if(void 0!==i){if(!Object(Ot.a)(s,o))return{};c=Object(wt.a)(s,o),p=5,u=i}else u=o,c=s;var d={};if(void 0!==i&&Object(l.a)(c[o],St.a)){var m=Object(Et.a)(c[o],St.a);return m.unshift(i),d[o]=n===o?m:Object(Tt.a)(m,p),d}e.setState({filterTerm:u});var h=function(t){if(!Object(Ot.a)(e.props.terms,t))return"continue";for(var s=u,r=u.length;r>1;r--)s+="|"+u.replace(new RegExp("(.{"+r+"})","g"),"$1.*");var a=new RegExp(s,"iu");if(n===t){var o=c[t],i=Object.keys(o),l=Object(xt.a)(i,(function(e){return o[e].name.match(a)||o[e].description.match(a)})),m=mt()(l,2),h=m[0],f=m[1],g=Object(Ct.a)(h,(function(e){var t=o[e],n=(t.name+" "+t.description).toLowerCase().indexOf(u.toLowerCase());return n>=0&&n}));d[t]=[].concat(pt()(g),pt()(f))}else d[t]=Object(Tt.a)(Object(St.a)(Object(A.a)(c[t],(function(e,t){return e.name.match(a)||e.description.match(a)?t:null}))),p)};for(var f in c)h(f);return e.removeEmptySuggestions(d)})),P()(w()(e),"createTaxonomySuggestionsArray",(function(e){var t=[],n=function(n){if(!Object(Ot.a)(e,n))return"continue";t.push.apply(t,pt()(e[n].map((function(e){return n+":"+e}))))};for(var s in e)n(s);return t})),P()(w()(e),"createTextWithHighlight",(function(e,t){var n=new RegExp("("+t+")","gi");return e.split(n).map((function(n,s){var r=e+s;return n.toLowerCase()===t?m.a.createElement("span",{key:r,className:"keyed-suggestions__value-emphasis"},n):m.a.createElement("span",{key:r,className:"keyed-suggestions__value-normal"},n)}))})),P()(w()(e),"onShowAllClick",(function(t){var n=e.narrowDownAndSort(e.props.input,t);e.setState({showAll:t,suggestions:n,taxonomySuggestionsArray:e.createTaxonomySuggestionsArray(n)})})),P()(w()(e),"createSuggestions",(function(t){var n=0,s=[],r={feature:b.a.translate("Feature",{context:"Theme Showcase filter name"}),layout:b.a.translate("Layout",{context:"Theme Showcase filter name"}),column:b.a.translate("Columns",{context:"Theme Showcase filter name"}),subject:b.a.translate("Subject",{context:"Theme Showcase filter name"}),style:b.a.translate("Style",{context:"Theme Showcase filter name"})},a=function(a){if(!Object(Ot.a)(t,a))return"continue";var o=t[a].length.toString(),i=Object.keys(e.props.terms[a]).length.toString();s.push(m.a.createElement("div",{className:"keyed-suggestions__category",key:a},m.a.createElement("span",{className:"keyed-suggestions__category-name"},r[a]),m.a.createElement("span",{className:"keyed-suggestions__category-counter"},b.a.translate("%(filtered)s of %(total)s",{args:{filtered:o,total:i}})),Object.keys(e.props.terms[a]).length>t[a].length&&m.a.createElement(Pt,{onClick:e.onShowAllClick,category:a,label:b.a.translate("Show all")}),a===e.state.showAll&&m.a.createElement(Pt,{onClick:e.onShowAllClick,category:"",label:b.a.translate("Show less")})));var c=e.props.terms;s.push(t[a].map((function(t,s){var r=c[a][t].name,o=n+s===e.state.suggestionPosition,i=D()("keyed-suggestions__value",{"has-highlight":o});return m.a.createElement("span",{className:i,onMouseDown:e.onMouseDown,onMouseOver:e.onMouseOver,key:a+"_"+s},m.a.createElement("span",{className:"keyed-suggestions__value-category"},a+":"+t+" "),m.a.createElement("span",{className:"keyed-suggestions__value-label-wigh-highlight"},e.createTextWithHighlight(r,e.state.filterTerm)),""!==c[a][t].description&&m.a.createElement("span",{className:"keyed-suggestions__value-description"},c[a][t].description))}))),n+=t[a].length};for(var o in t)a(o);return m.a.createElement("div",{className:"keyed-suggestions__suggestions"},s)})),e}return _()(n,[{key:"UNSAFE_componentWillMount",value:function(){this.setInitialState(this.props.input)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.input!==this.props.input&&this.setInitialState(e.input)}},{key:"render",value:function(){return m.a.createElement("div",{className:"keyed-suggestions"},this.createSuggestions(this.state.suggestions))}}]),n}(m.a.Component);P()(It,"propTypes",{suggest:N.a.func,terms:N.a.object,input:N.a.string}),P()(It,"defaultProps",{suggest:Ge.a,terms:{},input:""});var Nt=It,Rt=n("./components/sticky-panel/index.jsx"),Dt=n("../node_modules/lodash-es/get.js"),Ut=["column","feature","layout","subject","style"],At={color:"ink",column:"align-justify",feature:"customize",layout:"layout",subject:"info-outline",style:"themes"};function qt(e){return Object(Dt.a)(At,e,"tag")}var Lt=function(e){E()(n,e);var t=x()(n);function n(e){var s;return j()(this,n),s=t.call(this,e),P()(w()(s),"state",{suggestionPosition:-1}),P()(w()(s),"onMouseDown",(function(e){s.props.suggestionsCallback(e.target.getAttribute("data-key")+":"),e.stopPropagation(),e.preventDefault()})),P()(w()(s),"movePositionBy",(function(e){var t=s.state.suggestionPosition+e;t<0?t=s.visibleTaxonomies.length-1:t>s.visibleTaxonomies.length-1&&(t=0),s.setState({suggestionPosition:t})})),P()(w()(s),"handleKeyEvent",(function(e){var t=s.state.suggestionPosition;switch(e.key){case"ArrowDown":s.movePositionBy(1),e.preventDefault();break;case"ArrowUp":s.movePositionBy(-1),e.preventDefault();break;case"Enter":if(-1!==t)return s.props.suggestionsCallback(s.visibleTaxonomies[t]+":"),e.stopPropagation(),e.preventDefault(),!0}return!1})),P()(w()(s),"renderToken",(function(e){var t=D()("themes-magic-search-card__welcome-taxonomy","themes-magic-search-card__welcome-taxonomy-type-"+e,{"themes-magic-search-card__welcome-taxonomy-highlight":s.visibleTaxonomies[s.state.suggestionPosition]===e}),n={feature:b.a.translate("Feature",{context:"Theme Showcase filter name"}),layout:b.a.translate("Layout",{context:"Theme Showcase filter name"}),column:b.a.translate("Columns",{context:"Theme Showcase filter name"}),subject:b.a.translate("Subject",{context:"Theme Showcase filter name"}),style:b.a.translate("Style",{context:"Theme Showcase filter name"})};return m.a.createElement("div",{className:t,onMouseDownCapture:s.onMouseDown,key:e,"data-key":e},m.a.createElement(L.a,{icon:qt(e),className:"themes-magic-search-card__welcome-taxonomy-icon",size:18}),n[e]||b.a.translate("Unknown",{context:"Theme Showcase filter name"}))})),P()(w()(s),"renderTaxonomies",(function(){var e=s.props.taxonomies;return s.visibleTaxonomies=Object(bt.a)(e,Ut),s.visibleTaxonomies.map((function(e){return s.renderToken(e)}))})),s.visibleTaxonomies=[],s}return _()(n,[{key:"render",value:function(){return m.a.createElement("div",{className:"themes-magic-search-card__welcome"},m.a.createElement("div",{className:"themes-magic-search-card__welcome-header"},b.a.translate("Search by")),m.a.createElement("div",{className:"themes-magic-search-card__welcome-taxonomies"},this.renderTaxonomies()))}}]),n}(m.a.Component);Lt.propTypes={taxonomies:N.a.array,topSearches:N.a.array,suggestionsCallback:N.a.func},Lt.defaultProps={taxonomies:[],topSearches:[],suggestionsCallback:Ge.a};var zt=Lt,Mt=n("./state/themes/selectors/get-theme-filters.js"),Bt=n("../node_modules/lodash-es/mapValues.js"),Wt=n("../node_modules/lodash-es/keys.js"),Ft=n("../node_modules/lodash-es/forIn.js"),Vt=n("./state/themes/selectors/is-ambiguous-theme-filter-term.js");function Jt(e,t){var n=t.split(":")[1];return Object(Vt.a)(e,n)?t:n}var Ht=Object(_e.a)((function(e){var t={},n=Object(Bt.a)(Object(Mt.a)(e),Wt.a);return Object(Ft.a)(n,(function(n,s){n.forEach((function(n){var r="".concat(s,":").concat(n);t[r]=Jt(e,r)}))})),t}),(function(e){return[Object(Mt.a)(e)]})),Zt=(n("./my-sites/themes/themes-magic-search-card/style.scss"),["feature","layout","column","subject","style"]),Kt=function(e){E()(n,e);var t=x()(n);function n(e){var s;return j()(this,n),s=t.call(this,e),P()(w()(s),"setSuggestionsRefs",(function(e){return function(t){s.suggestionsRefs[e]=t}})),P()(w()(s),"setSearchInputRef",(function(e){return s.searchInputRef=e})),P()(w()(s),"onSearchOpen",(function(){s.setState({searchIsOpen:!0})})),P()(w()(s),"onSearchClose",(function(){s.setState({searchIsOpen:!1})})),P()(w()(s),"onKeyDown",(function(e){var t=e.target.value;s.findTextForSuggestions(t);var n=!1,r=""!==s.state.editedSearchElement?"suggestions":"welcome";s.suggestionsRefs[r]&&(n=s.suggestionsRefs[r].handleKeyEvent(e)),"Enter"===e.key&&!n&&s.isPreviousCharWhitespace()&&(s.searchInputRef.blur(),s.setState({searchIsOpen:!1}))})),P()(w()(s),"onClick",(function(e){s.findTextForSuggestions(e.target.value)})),P()(w()(s),"isPreviousCharWhitespace",(function(){var e=s.searchInputRef.searchInput,t=e.value,n=e.selectionStart,r=t.slice(0,n).length;return" "===t[r-1]})),P()(w()(s),"findEditedTokenIndex",(function(e,t){for(var n=0,s=0;s<e.length;s++){if(t<(n+=e[s].length))return s;if(t===n){var r=""===e[s].trim(),a=s<e.length-1;return r&&a?s+1:s}}return""})),P()(w()(s),"findTextForSuggestions",(function(e){var t=e;window.requestAnimationFrame((function(){s.setState({cursorPosition:t.slice(0,s.searchInputRef.searchInput.selectionStart).length});var n=e.split(/(\s+)/);if(""===n[n.length-1]&&n.splice(n.length-1,1),0!==n.length){var r=n[s.findEditedTokenIndex(n,s.state.cursorPosition)].trim();s.setState({editedSearchElement:r})}else s.setState({editedSearchElement:""})}))})),P()(w()(s),"insertSuggestion",(function(e){var t=s.state.searchInput.split(/(\s+)/);""===t[t.length-1]&&t.splice(t.length-1,1);var n=s.findEditedTokenIndex(t,s.state.cursorPosition),r=t[n+1]&&" "===t[n+1][0];return t[n]=r?e:e+" ",t.join("")})),P()(w()(s),"insertTextAtCursor",(function(e){var t=s.state.searchInput,n=s.state.cursorPosition;return t.slice(0,n)+e+t.slice(n)})),P()(w()(s),"onSearchChange",(function(e){s.findTextForSuggestions(e),s.setState({searchInput:e})})),P()(w()(s),"searchTokens",(function(e){return"undefined"!=typeof window&&/(Edge)/.test(window.navigator.userAgent)?m.a.createElement("div",null):e.split(/(\s+)/).map((function(e,t){if(""===e.trim())return m.a.createElement("span",{className:"themes-magic-search-card__search-white-space",key:t},e);if(Object(l.a)(s.props.allValidFilters,e)){var n=e.split(":"),r=mt()(n,2),a=r[0],o=r[1],i=D()("themes-magic-search-card__token","themes-magic-search-card__token-type-"+a);return m.a.createElement("span",{className:i,key:t},m.a.createElement("span",{className:"themes-magic-search-card__token-taxonomy"},a),m.a.createElement("span",{className:"themes-magic-search-card__token-separator"},":"),m.a.createElement("span",{className:"themes-magic-search-card__token-filter"},o))}return m.a.createElement("span",{className:"themes-magic-search-card__search-text",key:t},e)}))})),P()(w()(s),"updateInput",(function(e){s.setState({searchInput:e}),s.searchInputRef.clear()})),P()(w()(s),"suggest",(function(e){var t=s.insertSuggestion(e);s.updateInput(t)})),P()(w()(s),"insertTextInInput",(function(e){var t=s.insertTextAtCursor(e);s.updateInput(t)})),P()(w()(s),"focusOnInput",(function(){s.searchInputRef.focus()})),P()(w()(s),"clearSearch",(function(){s.updateInput(""),s.focusOnInput()})),P()(w()(s),"handleClickInside",(function(){s.focusOnInput()})),s.suggestionsRefs={},s.state={searchIsOpen:!1,editedSearchElement:"",cursorPosition:0,searchInput:s.props.search},s}return _()(n,[{key:"componentDidMount",value:function(){this.findTextForSuggestions(this.props.search)}},{key:"handleClickOutside",value:function(){this.setState({searchIsOpen:!1})}},{key:"render",value:function(){var e=this.props,t=e.translate,n=e.filters,s=e.showTierThemesControl,r=Be.a.isEnabled("upgrades/premium-themes"),a=[{value:"all",label:t("All")},{value:"free",label:t("Free")},{value:"premium",label:t("Premium")}],o=[].concat(pt()(Object(bt.a)(Zt,Object.keys(n))),pt()(Object(vt.a)(Object.keys(n),Zt))),i=m.a.createElement(jt.a,{onSearch:this.props.onSearch,initialValue:this.state.searchInput,value:this.state.searchInput,ref:this.setSearchInputRef,placeholder:t("I'm creating a site for a: portfolio, magazine, business, wedding, blog, or…"),analyticsGroup:"Themes",delaySearch:!0,onSearchOpen:this.onSearchOpen,onSearchClose:this.onSearchClose,onSearchChange:this.onSearchChange,onKeyDown:this.onKeyDown,onClick:this.onClick,overlayStyling:this.searchTokens,fitsContainer:this.props.isBreakpointActive&&this.state.searchIsOpen,hideClose:!0}),c=D()("themes-magic-search",{"has-keyed-suggestions":this.state.searchIsOpen}),l=D()("themes-magic-search-card",{"has-highlight":this.state.searchIsOpen}),u=""!==this.state.editedSearchElement;return m.a.createElement("div",{className:c},m.a.createElement(Rt.a,null,m.a.createElement("div",{className:l,role:"presentation","data-tip-target":"themes-search-card",onClick:this.handleClickInside},i,""!==this.state.searchInput&&m.a.createElement("div",{className:"themes-magic-search-card__icon"},m.a.createElement(L.a,{icon:"cross",className:"themes-magic-search-card__icon-close",tabIndex:"0",onClick:this.clearSearch,"aria-controls":"search-component-magic-search","aria-label":t("Clear Search")})),r&&s&&m.a.createElement(kt.a,{initialSelected:this.props.tier,options:a,onSelect:this.props.select}))),m.a.createElement("div",{role:"presentation",onClick:this.handleClickInside},u&&m.a.createElement(Nt,{ref:this.setSuggestionsRefs("suggestions"),terms:this.props.filters,input:this.state.editedSearchElement,suggest:this.suggest}),!u&&m.a.createElement(zt,{ref:this.setSuggestionsRefs("welcome"),taxonomies:o,topSearches:[],suggestionsCallback:this.insertTextInInput})))}}]),n}(m.a.Component);P()(Kt,"propTypes",{tier:N.a.string,select:N.a.func.isRequired,siteId:N.a.number,onSearch:N.a.func.isRequired,search:N.a.string,translate:N.a.func.isRequired,showTierThemesControl:N.a.bool,isBreakpointActive:N.a.bool}),P()(Kt,"defaultProps",{tier:"all",showTierThemesControl:!0});var Gt=Object(yt.a)(Object(g.c)((function(e){return{filters:Object(Mt.a)(e),allValidFilters:Object.keys(Ht(e))}})),b.c,gt.a,ht.e)(Kt),Yt=n("./components/data/query-theme-filters/index.jsx"),$t=n("./state/themes/selectors/find-theme-filter-term.js"),Qt=n("./state/themes/selectors/get-theme-filter-term.js");function Xt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.filter,s=t.tier,r=t.vertical;if(r){var a=Object(Dt.a)(Object(Qt.a)(e,"subject",r),"description");return a||"Discover ".concat(r," WordPress Themes on the WordPress.com Showcase. ")+"Here you can browse and find the best WordPress designs available on WordPress.com to discover the one that is just right for you."}if(n&&!Object(l.a)(n,"+")){var o=Object(Dt.a)(Object($t.a)(e,n),"description");return o||"Discover WordPress Themes supporting ".concat(n," on the WordPress.com Showcase. ")+"Here you can browse and find the best WordPress designs available on WordPress.com to discover the one that is just right for you."}return"free"===s?"Discover Free WordPress Themes on the WordPress.com Theme Showcase.":"premium"===s?"Discover Premium WordPress Themes on the WordPress.com Theme Showcase.":"Beautiful, responsive, free and premium WordPress themes for your photography site, portfolio, magazine, business website, or blog."}function en(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.filter,s=t.tier,r=t.vertical;if(r){var a=Object(Dt.a)(Object(Qt.a)(e,"subject",r),"name");if(a)return"".concat(a," WordPress Themes")}if(n&&!Object(l.a)(n,"+")){var o=Object(Dt.a)(Object($t.a)(e,n),"name");if(o)return"".concat(o," WordPress Themes")}return"free"===s?"Free WordPress Themes":"premium"===s?"Premium WordPress Themes":"WordPress Themes"}var tn=n("./state/themes/selectors/get-theme-filter-terms.js"),nn=n("./state/preferences/selectors.js"),sn=n("./state/preferences/actions.js"),rn=n("./state/ui/selectors/get-selected-site-id.js"),an=n("../node_modules/lodash-es/last.js");function on(e,t){var n=function(e,t){var n=(Object(nn.b)(e,"upwork-dismissible-banner")||{})[t]||[],s=Object(an.a)(n.filter((function(e){return"dismiss"===e.type})));return s?s.dismissedAt:0}(e,t);return 0!==n&&n>Date.now()-12096e5}var cn=n("./components/data/query-preferences/index.jsx"),ln=(n("./blocks/upwork-banner/style.scss"),function(e){E()(n,e);var t=x()(n);function n(){var e;j()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),P()(w()(e),"onDismissClick",(function(t){t.preventDefault(),t.stopPropagation(),e.recordEvent("calypso_upwork_banner_dismiss_icon_click"),e.props.dismissBanner(e.props.location)})),P()(w()(e),"onStartNowClick",(function(){e.recordEvent("calypso_upwork_banner_start_now_button_click")})),P()(w()(e),"recordEvent",(function(t){var n=e.props,s=n.currentPlan,r=n.location,a=s?s.productSlug:"";e.props.recordTracksEvent(t,ae()({location:r},a&&{plan:a}))})),e}return _()(n,[{key:"componentDidMount",value:function(){this.recordView()}},{key:"componentDidUpdate",value:function(e){e.siteId&&this.props.siteId&&this.props.siteId!==e.siteId&&this.recordView()}},{key:"recordView",value:function(){this.props.isBannerVisible&&this.recordEvent("calypso_upwork_banner_view")}},{key:"render",value:function(){var e=this.props,t=e.isBannerVisible,n=e.location,s=e.translate;return t?m.a.createElement("a",{className:"upwork-banner",role:"button",style:{backgroundColor:"#DAF5FC"},onClick:this.onStartNowClick,href:"/experts/upwork?source=".concat(n),target:"_blank",rel:"noopener noreferrer"},m.a.createElement(cn.a,null),m.a.createElement("h1",{className:"upwork-banner__title"},s("Need an expert to help realize your vision? Hire one!")),m.a.createElement("p",{className:"upwork-banner__description"},s("We've partnered with Upwork, a network of freelancers with a huge pool of WordPress experts. They know their stuff and they're waiting to help you build your dream site.")),m.a.createElement(le.a,{className:"upwork-banner__cta",compact:!0,primary:this.props.primaryButton},s("Find your expert")),m.a.createElement(le.a,{className:"upwork-banner__close",onClick:this.onDismissClick},m.a.createElement(L.a,{icon:"cross-small",size:18})),m.a.createElement("img",{alt:s("Upwork"),width:390,className:"upwork-banner__image",src:"/calypso/images/builder-referral-7b28c49a365131ec45f9abaaafe161d6.svg"})):null}}]),n}(d.PureComponent));P()(ln,"propTypes",{currentPlan:N.a.object,dismissBanner:N.a.func.isRequired,isBannerVisible:N.a.bool.isRequired,location:N.a.string.isRequired,recordTracksEvent:N.a.func.isRequired,siteId:N.a.number,translate:N.a.func.isRequired});var un=Object(g.c)((function(e,t){var n=Object(rn.a)(e);return{currentPlan:Object(te.a)(e,n),isBannerVisible:!on(e,t.location),siteId:n}}),{dismissBanner:function(e){return function(t,n){var s=Object(nn.b)(n(),"upwork-dismissible-banner")||{};return t(Object(sn.b)("upwork-dismissible-banner",ae()({},s,{},P()({},e,[].concat(pt()(s[e]||[]),[{dismissedAt:Date.now(),type:"dismiss"}])))))}},recordTracksEvent:ge.e})(Object(b.c)(ln)),pn=n("./components/spinner/index.jsx"),dn=n("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),mn=n.n(dn);function hn(e){return function(t){t({type:fe.f,payload:e})}}var fn=[];function gn(e){return e.themes.recommendedThemes.themes||fn}function bn(e){return e.themes.recommendedThemes.isLoading}var vn=function(e){E()(n,e);var t=x()(n);function n(){return j()(this,n),t.apply(this,arguments)}return _()(n,[{key:"componentDidMount",value:function(){this.props.recommendedThemes.length||this.props.getRecommendedThemes()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isLoading,s=t.isShowcaseOpen,r=t.scrollToSearchInput;e.isLoading!==n&&!1===n&&s&&r()}},{key:"render",value:function(){return m.a.createElement(m.a.Fragment,null,m.a.createElement("h2",null,m.a.createElement("strong",null,Object(b.f)("Recommended themes"))),this.props.isLoading?m.a.createElement(pn.a,{size:100}):m.a.createElement(Je,this.props))}}]),n}(m.a.Component),yn=Object(g.c)((function(e){return{recommendedThemes:gn(e),isLoading:bn(e)}}),{getRecommendedThemes:function(){return function(){var e=mn()(regeneratorRuntime.mark((function e(t){var n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:fe.e}),n={search:"",number:50,tier:"",filter:"auto-loading-homepage",apiVersion:"1.2"},e.prev=2,e.next=5,me.a.undocumented().themes(null,n);case 5:s=e.sent,t(hn(s)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t({type:fe.d});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()}})(vn),jn=(n("./my-sites/themes/theme-showcase.scss"),{photo:{icon:"camera",order:1},portfolio:{icon:"custom-post-type",order:2},magazine:{icon:"reader",order:3},blog:{icon:"posts",order:4},business:{icon:"cart",order:5},wedding:{icon:"heart",order:6},minimal:{icon:"minus-small",order:7},travel:{icon:"globe",order:8},food:{icon:"flip-horizontal",order:9},music:{icon:"audio",order:10}}),kn=N.a.shape({label:N.a.string,header:N.a.string,getUrl:N.a.func,action:N.a.func}),_n=function(e){E()(n,e);var t=x()(n);function n(e){var s;return j()(this,n),s=t.call(this,e),P()(w()(s),"scrollToSearchInput",(function(){!s.props.loggedOutComponent&&s.scrollRef&&s.scrollRef.current&&s.scrollRef.current.scrollIntoView()})),P()(w()(s),"toggleShowcase",(function(){s.setState({isShowcaseOpen:!s.state.isShowcaseOpen}),s.props.openThemesShowcase(),s.props.trackMoreThemesClick()})),P()(w()(s),"doSearch",(function(e){var t=/([\w-]*):([\w-]*)/g,n=s.props.filterToTermTable,r=(e.match(t)||[]).map((function(e){return n[e]})),a=s.constructUrl({filter:Object(c.a)(r).join("+"),searchString:e.replace(t,"").replace(/\s+/g," ").trim()});ie()(a),s.scrollToSearchInput()})),P()(w()(s),"constructUrl",(function(e){var t=ae()({},s.props,{},e),n=t.vertical,r=t.tier,a=t.filter,o=t.siteSlug,i=t.searchString,c=o?"/".concat(o):"",l=n?"/".concat(n):"",u=r&&"all"!==r?"/".concat(r):"",p=a?"/filter/".concat(a):"";p=p.replace(/\s/g,"+");var d="/themes".concat(l).concat(u).concat(p).concat(c);return Object(ot.a)(d,i)})),P()(w()(s),"onTierSelect",(function(e){var t=e.value;Object(B.c)("search bar filter",t);var n=s.constructUrl({tier:t});ie()(n),s.scrollToSearchInput()})),P()(w()(s),"onUploadClick",(function(){Object(B.c)("upload theme"),s.props.trackUploadClick(),s.props.atEnabled&&s.props.trackATUploadClick()})),P()(w()(s),"showUploadButton",(function(){var e=s.props,t=e.isMultisite;return e.isLoggedIn&&!t})),s.scrollRef=m.a.createRef(),s.bookmarkRef=m.a.createRef(),s.state={page:1,showPreview:!1,isShowcaseOpen:!!(s.props.loggedOutComponent||s.props.search||s.props.filter||s.props.tier||s.props.hasShowcaseOpened)},s}return _()(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.search,s=t.filter,r=t.tier,a=t.hasShowcaseOpened,o=t.themesBookmark;(n||s||r)&&!a&&this.props.openThemesShowcase(),o&&setTimeout((function(){var t=e.bookmarkRef.current;t&&t.scrollIntoView({behavior:"auto",block:"center",inline:"center"})}))}},{key:"componentDidUpdate",value:function(e){e.search===this.props.search&&e.filter===this.props.filter&&e.tier===this.props.tier||this.scrollToSearchInput()}},{key:"render",value:function(){var e=this,t=this.props,n=t.currentThemeId,s=t.siteId,r=t.options,a=t.getScreenshotOption,o=t.search,i=t.filter,c=t.translate,l=t.siteSlug,u=t.isLoggedIn,p=t.pathName,d=t.title,h=t.filterString,f=t.isMultisite,g=Be.a.isEnabled("upgrades/premium-themes")?this.props.tier:"free",b="https://wordpress.com"+p,v=[{name:"description",property:"og:description",content:this.props.description},{property:"og:title",content:d},{property:"og:url",content:b},{property:"og:type",content:"website"},{property:"og:site_name",content:"WordPress.com"}],y=[{rel:"canonical",href:b}],j=[{label:"new",uri:this.constructUrl({vertical:""}),icon:"star"}].concat(Object.keys(this.props.subjects).map((function(t){return jn[t]&&{label:t,uri:e.constructUrl({vertical:t}),icon:jn[t].icon,order:jn[t].order}})).filter((function(e){return!!e})).sort((function(e,t){return e.order-t.order}))),k=n||!s||!u,_=this.state.isShowcaseOpen,O=this.props.search||this.props.filter||this.props.tier;return m.a.createElement("div",null,m.a.createElement(at.a,{title:d,meta:v,link:y}),m.a.createElement(rt.a,{path:this.props.analyticsPath,title:this.props.analyticsPageTitle}),!u&&m.a.createElement(st,{options:j,fallback:j[0],uri:this.constructUrl()}),m.a.createElement("div",{className:"themes__content"},this.showUploadButton()&&m.a.createElement(le.a,{className:"themes__upload-button",compact:!0,onClick:this.onUploadClick,href:l?"/themes/upload/".concat(l):"/themes/upload"},m.a.createElement(L.a,{icon:"cloud-upload"}),c("Install theme")),!this.props.loggedOutComponent&&!O&&m.a.createElement(m.a.Fragment,null,m.a.createElement(yn,{upsellUrl:this.props.upsellUrl,search:o,tier:this.props.tier,filter:i,vertical:this.props.vertical,siteId:this.props.siteId,listLabel:this.props.listLabel,defaultOption:this.props.defaultOption,secondaryOption:this.props.secondaryOption,placeholderCount:this.props.placeholderCount,getScreenshotUrl:function(e){return a(e).getUrl?a(e).getUrl(e):null},onScreenshotClick:function(e){a(e).action&&a(e).action(e)},getActionLabel:function(e){return a(e).label},getOptions:function(e){return Object(U.a)(Object(B.a)(r),(function(t){return!(t.hideForTheme&&t.hideForTheme(e,s))}))},trackScrollPage:this.props.trackScrollPage,emptyContent:this.props.emptyContent,isShowcaseOpen:_,scrollToSearchInput:this.scrollToSearchInput,bookmarkRef:this.bookmarkRef}),m.a.createElement("div",{className:"theme-showcase__open-showcase-button-holder"},_?m.a.createElement("hr",null):m.a.createElement(le.a,{onClick:this.toggleShowcase,"data-e2e-value":"open-themes-button"},c("Show all themes")))),m.a.createElement("div",{ref:this.scrollRef,className:_?"theme-showcase__all-themes":"themes__hidden-content theme-showcase__all-themes"},!this.props.loggedOutComponent&&m.a.createElement(m.a.Fragment,null,m.a.createElement("h2",null,m.a.createElement("strong",null,c("Advanced Themes"))),m.a.createElement("p",null,c("These themes offer more power and flexibility, but can be harder to setup and customize.")),k&&ce.a&&"builderReferralBanner"===Object(ce.a)("builderReferralThemesBanner")&&m.a.createElement(un,{location:"theme-banner"})),m.a.createElement(Yt.a,null),m.a.createElement(Gt,{onSearch:this.doSearch,search:h+o,tier:g,showTierThemesControl:!f,select:this.onTierSelect}),this.props.upsellBanner,m.a.createElement(He,{upsellUrl:this.props.upsellUrl,search:o,tier:this.props.tier,filter:i,vertical:this.props.vertical,siteId:this.props.siteId,listLabel:this.props.listLabel,defaultOption:this.props.defaultOption,secondaryOption:this.props.secondaryOption,placeholderCount:this.props.placeholderCount,getScreenshotUrl:function(e){return a(e).getUrl?a(e).getUrl(e):null},onScreenshotClick:function(e){a(e).action&&a(e).action(e)},getActionLabel:function(e){return a(e).label},getOptions:function(e){return Object(U.a)(Object(B.a)(r),(function(t){return!(t.hideForTheme&&t.hideForTheme(e,s))}))},trackScrollPage:this.props.trackScrollPage,emptyContent:this.props.emptyContent,bookmarkRef:this.bookmarkRef}),m.a.createElement(it.a,null),this.props.children)))}}]),n}(m.a.Component);P()(_n,"propTypes",{currentThemeId:N.a.string,emptyContent:N.a.element,tier:N.a.oneOf(["","free","premium"]),search:N.a.string,pathName:N.a.string,options:N.a.objectOf(kn),defaultOption:kn,secondaryOption:kn,getScreenshotOption:N.a.func,siteSlug:N.a.string,upsellBanner:N.a.any,trackUploadClick:N.a.func,trackATUploadClick:N.a.func,trackMoreThemesClick:N.a.func,loggedOutComponent:N.a.bool}),P()(_n,"defaultProps",{tier:"",search:"",emptyContent:null,upsellBanner:!1,showUploadButton:!0});var On={trackUploadClick:function(){return Object(ge.e)("calypso_click_theme_upload")},trackATUploadClick:function(){return Object(ge.e)("calypso_automated_transfer_click_theme_upload")},trackMoreThemesClick:function(){return Object(ge.e)("calypso_themeshowcase_more_themes_clicked")},openThemesShowcase:function(){return Object(ct.a)()}},wn=Object(g.c)((function(e,t){var n=t.siteId,s=t.filter,r=t.tier,a=t.vertical;return{currentThemeId:Object(W.a)(e,n),isLoggedIn:!!Object(Pe.g)(e),siteSlug:Object(Ce.a)(e,n),description:Xt(e,{filter:s,tier:r,vertical:a}),title:en(e,{filter:s,tier:r,vertical:a}),subjects:Object(tn.a)(e,"subject")||{},filterString:Object(ve.a)(e,s),filterToTermTable:Ht(e),hasShowcaseOpened:Object(lt.c)(e),themesBookmark:Object(lt.b)(e)}}),On)(Object(b.c)(_n)),Sn=n("./state/selectors/is-vip-site.js"),En=Object(M.a)((function(e){var t=e.hasUnlimitedPremiumThemes,n=e.requestingSitePlans,s=e.siteId,r=e.isVip,a=e.siteSlug,o=e.translate,i=!n&&!t&&!r,c=!e.isJetpack,l="/plans/".concat(a),u=null;return i&&(u=c?m.a.createElement(X.a,{plan:ee.Ic,customerType:"business",className:"themes__showcase-banner",title:o("Unlock ALL premium themes with our Premium and Business plans!"),event:"themes_plans_free_personal",forceHref:!0,showIcon:!0}):m.a.createElement(X.a,{plan:ee.Ic,title:o("Access all our premium themes with our Premium and Business plans!"),description:o("Get advanced customization, more storage space, and video support along with all your new themes."),event:"themes_plans_free_personal",showIcon:!0})),m.a.createElement(v.a,{className:"themes"},m.a.createElement(G.a,null),m.a.createElement(Y.a,{className:"themes__page-heading",headerText:o("Themes"),align:"left"}),m.a.createElement(K,{siteId:s}),c?null:u,m.a.createElement(wn,f()({},e,{upsellUrl:l,upsellBanner:c?u:null,siteId:s}),s&&m.a.createElement(ne.a,{siteId:s}),s&&m.a.createElement(se.a,{siteId:s}),m.a.createElement($.a,{source:"list"}),m.a.createElement(Q.a,{source:"list"})))})),Tn=Object(g.c)((function(e,t){var n=t.siteId;return{isJetpack:Object(xe.a)(e,n),isVip:Object(Sn.a)(e,n),siteSlug:Object(Ce.a)(e,n),hasUnlimitedPremiumThemes:Object(te.i)(e,n,ee.Tb),requestingSitePlans:Object(te.l)(e,n)}}))(En),xn=n("./lib/purchases/index.js"),Cn=n("./components/empty-content/index.jsx"),Pn=n("./state/sites/selectors/get-site-admin-url.js"),In=Object(g.c)((function(e,t){var n=t.siteId;return{adminUrl:Object(Pn.a)(e,n,"themes.php")}}))(Object(b.c)((function(e){var t=e.siteId,n=e.translate,s=e.adminUrl,r=e.analyticsPath,a=e.analyticsPageTitle;return m.a.createElement(v.a,{className:"themes"},m.a.createElement(rt.a,{path:r,title:a}),m.a.createElement(G.a,null),m.a.createElement(K,{siteId:t}),m.a.createElement(Cn.a,{title:n("Changing Themes?"),line:n("Use your site theme browser to manage themes."),action:n("Open Site Theme Browser"),actionURL:s,actionTarget:"_blank",illustration:"/calypso/images/illustrations/illustration-jetpack.svg"}))}))),Nn=n("./my-sites/jetpack-manage-error-page/index.jsx"),Rn=Object(g.c)((function(e,t){var n=t.siteId;return{adminUrl:Object(Pn.a)(e,n,"themes.php")}}))(Object(b.c)((function(e){var t=e.siteId,n=e.translate,s=e.adminUrl;return m.a.createElement(v.a,{className:"themes"},m.a.createElement(G.a,null),m.a.createElement(Nn.a,{template:"updateJetpack",siteId:t,version:"3.7",secondaryAction:n("Open Site Theme Browser"),secondaryActionURL:s,secondaryActionTarget:"_blank"}))}))),Dn=n("./state/purchases/selectors.js"),Un=n("./state/themes/selectors/get-last-theme-query.js"),An=n("./state/sites/selectors/is-jetpack-site-multi-site.js"),qn=n("./state/sites/selectors/has-jetpack-site-jetpack-themes-extended-features.js"),Ln=n("./lib/version-compare/index.js"),zn=n("./state/sites/selectors/get-site-option.js");function Mn(e,t){if(!Object(xe.a)(e,t))return null;var n=Object(zn.a)(e,t,"jetpack_version");return Object(Ln.a)(n,"3.7-beta")>=0}var Bn=Object(M.a)((function(e){return m.a.createElement(He,f()({},e,{getOptions:function(t){return Object(U.a)(Object(B.a)(e.options),(function(n){return!(n.hideForTheme&&n.hideForTheme(t,e.siteId))}))}}))})),Wn=Object(M.a)((function(e){var t=e.analyticsPath,n=e.analyticsPageTitle,s=e.currentPlan,r=e.emptyContent,a=e.filter,o=e.getScreenshotOption,i=e.hasJetpackThemes,c=e.purchase,l=e.showWpcomThemesList,u=e.search,p=e.siteId,d=e.vertical,h=e.tier,g=e.translate,b=e.hasUnlimitedPremiumThemes,y=e.requestingSitePlans;if(!Be.a.isEnabled("manage/themes-jetpack"))return m.a.createElement(In,{siteId:p,analyticsPath:t,analyticsPageTitle:n});if(!i)return m.a.createElement(Rn,{siteId:p});var j=c&&Object(xn.A)(c);return m.a.createElement(v.a,{className:"themes"},m.a.createElement(G.a,null),m.a.createElement(Y.a,{className:"themes__page-heading",headerText:g("Themes"),align:"left"}),m.a.createElement(K,{siteId:p}),!y&&s&&!b&&!j&&m.a.createElement(X.a,{forceDisplay:!0,plan:ee.yc,title:g("Access all our premium themes with our Professional plan!"),description:g("In addition to our collection of premium themes, get Elasticsearch-powered site search, real-time offsite backups, and security scanning."),event:"themes_plans_free_personal_premium",showIcon:!0}),m.a.createElement(wn,f()({},e,{siteId:p,emptyContent:l?m.a.createElement("div",null):null}),p&&m.a.createElement(ne.a,{siteId:p}),p&&m.a.createElement(se.a,{siteId:p}),m.a.createElement($.a,{source:"list"}),m.a.createElement(Q.a,{source:"list"}),l&&m.a.createElement("div",null,m.a.createElement(Bn,{origin:"wpcom",defaultOption:"activate",secondaryOption:"tryandcustomize",search:u,tier:h,filter:a,vertical:d,siteId:p,getScreenshotUrl:function(e){return o(e).getUrl?o(e).getUrl(e):null},onScreenshotClick:function(e){o(e).action&&o(e).action(e)},getActionLabel:function(e){return o(e).label},trackScrollPage:e.trackScrollPage,source:"wpcom",emptyContent:r}))))})),Fn=Object(g.c)((function(e,t){var n=t.siteId,s=t.tier,r=Object(te.a)(e,n),a=Object(An.a)(e,n),o=Object(qn.a)(e,n)&&!a,i=null;if(o){var c=Object(Un.a)(e,n),l=Object(Un.a)(e,"wpcom"),u=Ue(e,n,c),p=Ue(e,"wpcom",l);i=u||p?m.a.createElement("div",null):null}return{currentPlan:r,hasJetpackThemes:Mn(e,n),purchase:r?Object(Dn.a)(e,r.id):null,tier:s,showWpcomThemesList:o,emptyContent:i,isMultisite:a,hasUnlimitedPremiumThemes:Object(te.i)(e,n,ee.Tb),requestingSitePlans:Object(te.l)(e,n)}}))(Wn),Vn=Object(g.c)((function(e){var t=Object(rn.a)(e);return{siteId:t,isJetpack:Object(xe.a)(e,t),getScreenshotOption:function(n){return Object(Ie.a)(e,n,t)?"customize":"info"}}}))(Object(b.c)((function(e){var t=e.isJetpack,n=e.siteId,s=e.translate;return n?t?m.a.createElement(Fn,f()({},e,{siteId:n,defaultOption:"activate",secondaryOption:"tryandcustomize",source:"showcase",listLabel:s("Uploaded themes"),placeholderCount:5})):m.a.createElement(Tn,f()({},e,{origin:"wpcom",siteId:n,defaultOption:"activate",secondaryOption:"tryandcustomize",source:"showcase"})):m.a.createElement(v.a,{className:"themes"})}))),Jn=n("./my-sites/themes/themes-site-selector-modal.jsx"),Hn=Object(M.a)((function(e){return m.a.createElement(v.a,{className:"themes"},m.a.createElement(G.a,null),m.a.createElement(Jn.a,e,m.a.createElement(wn,{source:"showcase",showUploadButton:!1})))})),Zn=function(e){return m.a.createElement(Hn,f()({},e,{origin:"wpcom",defaultOption:"activate",secondaryOption:"tryandcustomize",getScreenshotOption:function(){return"info"}}))},Kn=Object(M.a)(wn),Gn=function(e){return m.a.createElement(v.a,{className:"themes"},m.a.createElement(Kn,f()({},e,{origin:"wpcom",defaultOption:"signup",getScreenshotOption:function(){return"info"},source:"showcase",showUploadButton:!1,loggedOutComponent:!0})))},Yn=n("./components/header-cake/index.jsx"),$n=n("../packages/components/dist/esm/progress-bar/index.js"),Qn=n("./blocks/upload-drop-zone/index.jsx"),Xn=n("./notices/index.js"),es=n("./state/themes/actions/receive-theme.js");var ts=n("./state/themes/actions/theme-transfer.js"),ns=n("./state/ui/selectors/get-selected-site.js"),ss=n("./state/ui/selectors/get-selected-site-slug.js");function rs(e,t){return Object(Dt.a)(e.themes.uploadTheme.inProgress,t,!1)}function as(e,t){return!(rs(e,t)||!is(e,t))}function os(e,t){return!!Object(Dt.a)(e.themes.uploadTheme.uploadError,t,!1)}function is(e,t){var n=Object(Dt.a)(e.themes.uploadTheme.uploadedThemeId,t);return n?n.replace(/-wpcom$/,""):null}function cs(e,t){return Object(Dt.a)(e.themes.uploadTheme.uploadError,t)}function ls(e,t){return Object(Dt.a)(e.themes.uploadTheme.progressTotal,t)}function us(e,t){return Object(Dt.a)(e.themes.uploadTheme.progressLoaded,t)}function ps(e,t){return ls(e,t)===us(e,t)}var ds=n("./blocks/eligibility-warnings/index.tsx"),ms=n("./components/data/query-atat-eligibility/index.jsx"),hs=n("./state/automated-transfer/selectors/index.ts"),fs=n("./state/selectors/is-site-automated-transfer.js"),gs=n("./components/wpadmin-auto-login/index.jsx"),bs=n("./my-sites/feature-upsell/redirect-if.jsx"),vs=(n("./my-sites/themes/theme-upload/style.scss"),p()("calypso:themes:theme-upload")),ys=function(e){E()(n,e);var t=x()(n);function n(){var e;j()(this,n);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),P()(w()(e),"state",{showEligibility:e.props.showEligibility}),P()(w()(e),"onProceedClick",(function(){e.setState({showEligibility:!1})})),P()(w()(e),"onActivateClick",(function(){e.props.options.activate.action(e.props.themeId)})),P()(w()(e),"onTryAndCustomizeClick",(function(){e.props.options.tryandcustomize.action(e.props.themeId)})),e}return _()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.siteId;!e.inProgress&&this.props.clearThemeUpload(t)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.siteId!==this.props.siteId){var t=e.siteId;!e.inProgress&&this.props.clearThemeUpload(t)}e.showEligibility!==this.props.showEligibility&&this.setState({showEligibility:e.showEligibility})}},{key:"componentDidUpdate",value:function(e){this.props.complete&&!e.complete?this.successMessage():this.props.failed&&!e.failed&&this.failureMessage()}},{key:"successMessage",value:function(){var e=this.props,t=e.translate,n=e.uploadedTheme,s=e.themeId;Xn.a.success(t("Successfully uploaded theme %(name)s",{args:{name:n?n.name:s}}),{duration:5e3})}},{key:"failureMessage",value:function(){var e=this.props,t=e.translate,n=e.error;vs("Error",{error:n});var s={exists:t("Install problem: Theme already installed on site."),already_installed:t("Install problem: Theme already installed on site."),"too large":t("Install problem: Theme zip must be under 10MB."),incompatible:t("Install problem: Incompatible theme."),unsupported_mime_type:t("Install problem: Not a valid zip file"),initiate_failure:t("Install problem: Theme may not be valid. Check that your zip file contains only the theme you are trying to install.")},r=JSON.stringify(n).toLowerCase(),a=Object(Ze.a)(s,(function(e,t){return Object(l.a)(r,t)})),o=n.error?": ".concat(n.error):"";Xn.a.error(a||t("Problem installing theme")+o)}},{key:"renderProgressBar",value:function(){var e=this.props,t=e.translate,n=e.progressTotal,s=e.progressLoaded,r=e.installing,a=t("Uploading your theme…"),o=this.props.isJetpack?t("Installing your theme…"):t("Configuring your site…");return m.a.createElement("div",null,m.a.createElement("span",{className:"theme-upload__title"},r?o:a),m.a.createElement($n.a,{value:s||0,total:n||100,title:t("Uploading progress"),isPulsing:r}))}},{key:"renderTheme",value:function(){var e=this.props,t=e.uploadedTheme,n=e.translate,s=e.options,r=s.tryandcustomize,a=s.activate;return m.a.createElement("div",{className:"theme-upload__theme-sheet"},m.a.createElement("img",{className:"theme-upload__screenshot",src:t.screenshot,alt:""}),m.a.createElement("h2",{className:"theme-upload__theme-name"},t.name),m.a.createElement("div",{className:"theme-upload__author"},n("by "),m.a.createElement("a",{href:t.author_uri},t.author)),m.a.createElement("div",{className:"theme-upload__description"},t.description),m.a.createElement("div",{className:"theme-upload__action-buttons"},m.a.createElement(le.a,{onClick:this.onTryAndCustomizeClick},r.label),m.a.createElement(le.a,{primary:!0,onClick:this.onActivateClick},a.label)))}},{key:"renderUploadCard",value:function(){var e=this.props,t=e.inProgress,n=e.failed,s=e.uploadedTheme,r=e.complete,a=e.isJetpack,o=e.isBusiness,i=a?this.props.uploadTheme:this.props.initiateThemeTransfer,c=!o&&!a;return m.a.createElement(q.a,null,!t&&!r&&m.a.createElement(Qn.a,{doUpload:i,disabled:c}),t&&this.renderProgressBar(),r&&!n&&s&&this.renderTheme(),r&&this.props.isSiteAutomatedTransfer&&m.a.createElement(gs.a,{site:this.props.selectedSite}))}},{key:"renderNotAvailableForMultisite",value:function(){return m.a.createElement(Cn.a,{title:this.props.translate("Not available for multi site"),line:this.props.translate("Use the WP Admin interface instead"),action:this.props.translate("Open WP Admin"),actionURL:this.props.siteAdminUrl,illustration:"/calypso/images/illustrations/illustration-jetpack.svg"})}},{key:"render",value:function(){var e=this.props,t=e.translate,n=e.complete,s=e.siteId,r=e.themeId,a=e.upgradeJetpack,o=e.backPath,i=e.isMultisite,c=this.state.showEligibility;return i?this.renderNotAvailableForMultisite():m.a.createElement(v.a,null,m.a.createElement(rt.a,{path:"/themes/upload/:site",title:"Themes > Install"}),m.a.createElement(ms.a,{siteId:s}),m.a.createElement(V.a,{siteId:s}),r&&n&&m.a.createElement(J.a,{siteId:s,themeId:r}),m.a.createElement($.a,{source:"upload"}),m.a.createElement(Q.a,{source:"upload"}),m.a.createElement(Yn.a,{backHref:o},t("Install theme")),a&&m.a.createElement(Nn.a,{template:"updateJetpack",siteId:s,featureExample:this.renderUploadCard(),version:"4.7"}),c&&m.a.createElement(ds.a,{backUrl:o,onProceed:this.onProceedClick}),!a&&!c&&this.renderUploadCard())}}]),n}(m.a.Component);P()(ys,"propTypes",{siteId:N.a.number,selectedSite:N.a.object,useUpsellPage:N.a.bool,inProgress:N.a.bool,complete:N.a.bool,failed:N.a.bool,uploadedTheme:N.a.object,error:N.a.object,progressTotal:N.a.number,progressLoaded:N.a.number,installing:N.a.bool,isJetpack:N.a.bool,upgradeJetpack:N.a.bool,backPath:N.a.string,showEligibility:N.a.bool});var js=Object(M.a)(ys),ks=[Object(g.c)((function(e){var t=Object(rn.a)(e),n=Object(ns.a)(e),s=is(e,t),r=Object(xe.a)(e,t),a=Object(hs.a)(e,t),o=a.eligibilityHolds,c=a.eligibilityWarnings,l=Object(hs.b)(e,t),u=!(Object(i.a)(o)&&Object(i.a)(c));return{siteId:t,siteSlug:Object(ss.a)(e),isBusiness:Object(te.i)(e,t,ee.Tb),selectedSite:n,isJetpack:r,inProgress:rs(e,t),complete:as(e,t),failed:os(e,t),themeId:s,isMultisite:Object(An.a)(e,t),uploadedTheme:Object(F.a)(e,t,s),error:cs(e,t),progressTotal:ls(e,t),progressLoaded:us(e,t),installing:ps(e,t),upgradeJetpack:r&&!Object(qn.a)(e,t),backPath:Object(lt.a)(e),showEligibility:!r&&(u||!l),isSiteAutomatedTransfer:Object(fs.a)(e,t),siteAdminUrl:Object(Pn.a)(e,t)}}),{uploadTheme:function(e,t){return function(n){return n({type:fe.T,siteId:e}),me.a.undocumented().uploadTheme(e,t,(function(t){n({type:fe.S,siteId:e,loaded:t.loaded,total:t.total})})).then((function(t){n(Object(es.a)(t,e)),n({type:fe.U,siteId:e,themeId:t.id})})).catch((function(t){n({type:fe.R,siteId:e,error:t})}))}},clearThemeUpload:function(e){return{type:fe.Q,siteId:e}},initiateThemeTransfer:ts.a}),b.c];Be.a.isEnabled("upsell/nudge-a-palooza")&&ks.push(Object(bs.a)((function(e,t){return!Object(xe.a)(e,t)&&!Object(te.i)(e,t,ee.Yb)&&"test"===Object(ce.a)("themesUpsellLandingPage")}),"/feature/themes"));var _s=yt.a.apply(void 0,ks)((function(e){var t=e.siteId,n=e.uploadedTheme;return m.a.createElement(js,f()({},e,{siteId:t,theme:n}))})),Os=n("./lib/analytics/page-view.js"),ws=n("./lib/analytics/mc.js"),Ss=n("./lib/analytics/ga.js"),Es=n("./state/themes/actions/set-back-path.js"),Ts=n("./state/themes/actions/request-theme-filters.js"),xs=p()("calypso:themes");function Cs(e){var t=e.params,n=t.tier,s=t.filter,r=t.vertical,a=Object(B.b)(e.path,e.params),o=a.analyticsPath,i=a.analyticsPageTitle;return{tier:n,filter:s,vertical:r,analyticsPageTitle:i,analyticsPath:o,search:e.query.s,pathName:e.pathname,trackScrollPage:function(){var e,t,n,s;e=o,t=i,n="Themes",Object(Ss.a)(n,"Loaded Next Page","page",s),Object(Os.a)(e,t),Object(ws.a)("newdash_pageviews","scroll")}}}function Ps(e,t){Object(o.a)(e.prevPath,"/themes")&&!Object(o.a)(e.prevPath,"/themes/upload")&&e.store.dispatch(Object(Es.a)(e.prevPath)),e.primary=m.a.createElement(_s,null),t()}function Is(e,t){"undefined"!=typeof window&&window.scrollTo(0,0);var n=e.params.site_id?Vn:Zn;e.primary=m.a.createElement(n,Cs(e)),t()}function Ns(e,t){if(e.isServerSide&&!Object(i.a)(e.query))return t();var n=Cs(e);e.primary=m.a.createElement(Gn,n),t()}function Rs(e,t){var n=e.store;if(!Object(i.a)(Object(Mt.a)(n.getState())))return xs("found theme filters in cache"),t();var s=n.subscribe((function(){if(!Object(i.a)(Object(Mt.a)(n.getState())))return s(),t()}));n.dispatch(Object(Ts.a)())}var Ds=n("./state/themes/selectors/is-valid-theme-filter-term.js"),Us=n("./state/themes/selectors/get-theme-filter-string-from-term.js");function As(e,t){if(!e.params.filter)return t();var n=e.params.filter.replace(/\s/g,"+"),s=n.split(/[,+]/).filter((function(t){return Object(Ds.a)(e.store.getState(),t)})),r=function(e,t){return t.map((function(t){return Object(Us.a)(e.store.getState(),t)})).sort().map((function(t){return Jt(e.store.getState(),t)}))}(e,s).join("+");if(r!==n){var a=e.path.replace("/filter/".concat(n),r?"/filter/".concat(r):"");return e.isServerSide?e.res.redirect(a):ie.a.redirect(a)}t()}function qs(e,t){var n=e.params.vertical,s=e.store;return n?Object(Qt.a)(s.getState(),"subject",n)?void t():e.isServerSide?t("route"):void 0:t()}function Ls(e,t){e.params.site_id?Object(r.d)(e,t):t()}t.default=function(e){var t=!!Object(s.default)().get(),n="\\d+|[^\\\\/.]+\\.[^\\\\/]+",o=["/themes/:tier(free|premium)?/:site_id(".concat(n,")?"),"/themes/:tier(free|premium)?/filter/:filter/:site_id(".concat(n,")?"),"/themes/:vertical?/:tier(free|premium)?/:site_id(".concat(n,")?"),"/themes/:vertical?/:tier(free|premium)?/filter/:filter/:site_id(".concat(n,")?")];e("/themes/upload",r.d,a.e,a.f,r.c),e("/themes/upload/:site_id",r.d,a.e,Ps,a.b,r.c),t?e(o,Rs,qs,As,a.e,Is,a.b,r.c):e(o,Ls,Rs,qs,As,Ns,r.c)}},"./my-sites/themes/theme-showcase.scss":function(e,t,n){},"./my-sites/themes/theme-upload/style.scss":function(e,t,n){},"./my-sites/themes/themes-magic-search-card/style.scss":function(e,t,n){},"./my-sites/themes/themes-selection.scss":function(e,t,n){}}]);
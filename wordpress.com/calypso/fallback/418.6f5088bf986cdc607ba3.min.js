(window.webpackJsonp=window.webpackJsonp||[]).push([[418],{"./components/popover/index.jsx":function(e,t,o){"use strict";var n=o("../node_modules/@babel/runtime/helpers/extends.js"),i=o.n(n),s=o("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=o.n(s),l=o("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),a=o.n(l),c=o("../node_modules/@babel/runtime/helpers/classCallCheck.js"),d=o.n(c),u=o("../node_modules/@babel/runtime/helpers/createClass.js"),p=o.n(u),f=o("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=o.n(f),m=o("../node_modules/@babel/runtime/helpers/inherits.js"),v=o.n(m),b=o("../node_modules/@babel/runtime/helpers/createSuper.js"),g=o.n(b),w=o("../node_modules/@babel/runtime/helpers/defineProperty.js"),y=o.n(w),k=o("../node_modules/prop-types/index.js"),C=o.n(k),P=o("../node_modules/react/index.js"),E=o.n(P),j=o("../node_modules/react-dom/index.js"),R=o.n(j),L=o("../node_modules/debug/src/browser.js"),O=o.n(L),N=o("../node_modules/classnames/index.js"),x=o.n(N),_=o("../node_modules/lodash-es/defer.js"),T=o("../node_modules/lodash-es/noop.js"),D=o("../packages/i18n-calypso/dist/esm/index.js"),M=o("../packages/components/dist/esm/root-child/index.js"),W=O()("calypso:popover:util");function U(){var e={};return e.top=window.scrollY,e.left=window.scrollX,e.width=window.innerWidth,e.height=window.innerHeight,e.right=e.left+e.width,e.bottom=e.top+e.height,W("viewport: %o",e),e}var F={top:"bottom",bottom:"top",left:"right",right:"left"},z={top:"right",left:"top",bottom:"left",right:"bottom"},K=null,H=0;function I(){return K||(K=U()),K}function A(){K=U()}function B(e,t,o){var n=I(),i=o.getBoundingClientRect(),s=t.clientHeight,l=t.clientWidth,a={top:i.top-s,bottom:n.height-i.bottom-s,left:i.left-l,right:n.width-i.right-l},c=e.split(/\s+/),d=r()(c,1)[0],u=r()(c,2)[1],p=function(e,t){for(var o,n=[e,F[e],z[e],F[z[e]]],i=-1/0,s=0,r=n.length;s<r;s++){var l=n[s],a=t[l];if(a>0)return l;a>i&&(i=a,o=e)}return o}(d,a);return u!==p&&u!==F[p]||(u=null),function(e,t,o,n,i,s){for(var r,l=I(),a="top"===e||"bottom"===e,c=t?[a?"".concat(e," ").concat(t):"".concat(t," ").concat(e),e,a?"".concat(e," ").concat(F[t]):"".concat(F[t]," ").concat(e)]:[e,a?"".concat(e," ").concat(z[e]):"".concat(z[e]," ").concat(e),a?"".concat(e," ").concat(F[z[e]]):"".concat(F[z[e]]," ").concat(e)],d=0,u=i*s,p=0,f=c.length;p<f;p++){var h=c[p],m=S(h,o,n),v=m.left+i,b=m.top+s,g=Math.min(m.top<l.top?b-l.top:l.bottom-m.top,s),w=Math.min(m.left<l.left?v-l.left:l.right-m.left,i)*g;if(w===u)return h;w>d&&(d=w,r=h)}return r}(p,u,t,o,l,s)||e}function S(e,t,o,n){var i=t.getBoundingClientRect();if(!i)throw new Error("could not get bounding client rect of Tip element");var s=i.width,r=i.height,l=o.getBoundingClientRect();if(!l)throw new Error("could not get bounding client rect of `target`");var a,c,d,u,p,f,h,m,v=l.width,b=l.height,g=(a=l,c=document,d=c.body||c.getElementsByTagName("body")[0],u=c.documentElement||d.parentNode,p=u.clientTop||d.clientTop||0,f=u.clientLeft||d.clientLeft||0,h=window.pageYOffset||u.scrollTop,m=window.pageXOffset||u.scrollLeft,{top:a.top+h-p,left:a.left+m-f});if(!g)throw new Error("could not determine page offset of `target`");var w={};switch(e){case"top":w={top:g.top-r,left:n&&n.left?g.left+n.left:g.left+v/2-s/2};break;case"bottom":w={top:g.top+b,left:n&&n.left?g.left+n.left:g.left+v/2-s/2};break;case"right":w={top:g.top+b/2-r/2,left:g.left+v};break;case"left":w={top:g.top+b/2-r/2,left:g.left-s};break;case"top left":w={top:g.top-r,left:g.left+v/2-s+15};break;case"top right":w={top:g.top-r,left:g.left+v/2-15};break;case"bottom left":w={top:g.top+b,left:g.left+v/2-s+15};break;case"bottom right":w={top:g.top+b,left:g.left+v/2-15};break;case"left top":w={top:g.top+b/2-r,left:g.left-s};break;case"left bottom":w={top:g.top+b/2,left:g.left-s};break;case"right top":w={top:g.top+b/2-r,left:g.left+v};break;case"right bottom":w={top:g.top+b/2,left:g.left+v};break;default:throw new Error('invalid position "'.concat(e,'"'))}return w}o("./components/popover/style.scss");var V=O()("calypso:popover"),J=function(e){v()(o,e);var t=g()(o);function o(){var e;d()(this,o);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e=t.call.apply(t,[this].concat(i)),y()(h()(e),"scheduledPositionUpdate",null),y()(h()(e),"scheduledFocus",null),y()(h()(e),"popoverNodeRef",E.a.createRef()),y()(h()(e),"popoverInnerNodeRef",E.a.createRef()),y()(h()(e),"state",{left:-99999,top:-99999,positionClass:e.getPositionClass(e.props.position)}),y()(h()(e),"onKeydown",(function(t){if(27===t.keyCode){var o=R.a.findDOMNode(e.props.context);o&&(V("Refocusing the previous active DOM node"),o.focus()),e.close(!0)}})),y()(h()(e),"onClickout",(function(t){var o=e.popoverInnerNodeRef.current,n=o&&!o.contains(t.target);if(n&&e.props.context){var i=R.a.findDOMNode(e.props.context);n=i&&!i.contains(t.target)}if(n&&e.props.ignoreContext){var s=R.a.findDOMNode(e.props.ignoreContext);n=s&&!s.contains(t.target)}n&&e.close()})),y()(h()(e),"onWindowChange",(function(){e.setPosition()})),y()(h()(e),"setPosition",(function(){var t;V("updating position"),(t=e.props.customPosition?Object.assign({positionClass:e.getPositionClass(e.constructor.defaultProps.position)},e.props.customPosition):e.computePosition())&&e.setState(t)})),e}return p()(o,[{key:"componentDidMount",value:function(){this.bindListeners(),this.setPositionAndFocus()}},{key:"componentDidUpdate",value:function(){var e=this;null==this.scheduledPositionUpdate&&(this.scheduledPositionUpdate=Object(_.a)((function(){e.setPosition(),e.scheduledPositionUpdate=null})))}},{key:"componentWillUnmount",value:function(){this.unbindListeners()}},{key:"bindListeners",value:function(){this.bindClickoutHandler(),this.bindEscKeyListener(),this.bindReposition(),H++>0||(W("bind handlers to `resize` and `scroll` events"),window.addEventListener("resize",A,!0),window.addEventListener("scroll",A,!0))}},{key:"unbindListeners",value:function(){this.unbindClickoutHandler(),this.unbindEscKeyListener(),this.unbindReposition(),--H>0||(W("unbind handlers to `resize` and `scroll` events"),window.removeEventListener("resize",A,!0),window.removeEventListener("scroll",A,!0)),null!=this.scheduledPositionUpdate&&(window.clearTimeout(this.scheduledPositionUpdate),this.scheduledPositionUpdate=null),null!=this.scheduledFocus&&(window.clearTimeout(this.scheduledFocus),this.scheduledFocus=null)}},{key:"bindEscKeyListener",value:function(){this.props.closeOnEsc&&document.addEventListener("keydown",this.onKeydown,!0)}},{key:"unbindEscKeyListener",value:function(){this.props.closeOnEsc&&document.removeEventListener("keydown",this.onKeydown,!0)}},{key:"bindClickoutHandler",value:function(){document.addEventListener("click",this.onClickout,!0)}},{key:"unbindClickoutHandler",value:function(){document.removeEventListener("click",this.onClickout,!0)}},{key:"bindReposition",value:function(){window.addEventListener("scroll",this.onWindowChange,!0),window.addEventListener("resize",this.onWindowChange,!0)}},{key:"unbindReposition",value:function(){window.removeEventListener("scroll",this.onWindowChange,!0),window.removeEventListener("resize",this.onWindowChange,!0)}},{key:"setPositionAndFocus",value:function(){this.setPosition(),this.focusPopover()}},{key:"focusPopover",value:function(){var e=this;this.scheduledFocus=Object(_.a)((function(){e.popoverNodeRef.current&&(V("focusing the popover"),e.popoverNodeRef.current.focus()),e.scheduledFocus=null}))}},{key:"getPositionClass",value:function(e){return"is-".concat(e.replace(/\s+/g,"-"))}},{key:"adjustRtlPosition",value:function(e){if(this.props.isRtl)switch(e){case"top right":case"right top":return"top left";case"right":return"left";case"bottom right":case"right bottom":return"bottom left";case"bottom left":case"left bottom":return"bottom right";case"left":return"right";case"top left":case"left top":return"top right"}return e}},{key:"computePosition",value:function(){var e=this.props,t=e.position,o=e.relativePosition,n=this.popoverInnerNodeRef.current,i=R.a.findDOMNode(this.props.context);if(!i)return V("[WARN] no DOM elements to work"),null;var s=t;V("position: %o",s),this.props.autoRtl&&(s=this.adjustRtlPosition(s),V("RTL adjusted position: %o",s)),this.props.autoPosition&&(s=B(s,n,i),V("suggested position: %o",s));var r,l,a,c,d=Object.assign({},(r=S(s,n,i,o),l=n,a=I(),c=l.getBoundingClientRect().width,r.left=Math.max(0,Math.min(r.left,a.width-c)),r),{positionClass:this.getPositionClass(s)});return V("updating reposition: ",d),d}},{key:"getStylePosition",value:function(){var e=this.state;return{left:e.left,top:e.top}}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.onClose(e)}},{key:"render",value:function(){if(!this.props.context)return V("No `context` to tie. return no render"),null;var e=x()("popover",this.props.className,this.state.positionClass);return E.a.createElement("div",{ref:this.popoverNodeRef,"aria-label":this.props["aria-label"],id:this.props.id,role:"tooltip",tabIndex:"-1",style:this.getStylePosition(),className:e},E.a.createElement("div",{className:"popover__arrow"}),E.a.createElement("div",{ref:this.popoverInnerNodeRef,className:"popover__inner"},this.props.children))}}]),o}(P.Component);function X(e){var t=e.isVisible,o=void 0!==t&&t,n=e.showDelay,s=void 0===n?0:n,l=a()(e,["isVisible","showDelay"]),c=Object(D.g)(),d=E.a.useState(o),u=r()(d,2),p=u[0],f=u[1];return E.a.useEffect((function(){if(s>0&&p!==o&&o){V("showing in ".concat(s," ms"));var e=setTimeout((function(){f(!0)}),s);return function(){clearTimeout(e)}}}),[s,o,p]),p===o||0!==s&&o||f(o),p?E.a.createElement(M.a,null,E.a.createElement(J,i()({},l,{isRtl:c}))):(V("is hidden. return no render"),null)}y()(J,"defaultProps",{autoPosition:!0,autoRtl:!0,className:"",closeOnEsc:!0,isRtl:!1,position:"top",onClose:T.a});var Y=C.a.oneOfType([C.a.instanceOf(P.Component),C.a.instanceOf("undefined"!=typeof window?window.Element:Object)]);X.propTypes={autoPosition:C.a.bool,autoRtl:C.a.bool,className:C.a.string,closeOnEsc:C.a.bool,id:C.a.string,context:Y,ignoreContext:Y,isVisible:C.a.bool,position:C.a.oneOf(["top","top right","right","bottom right","bottom","bottom left","left","top left"]),showDelay:C.a.number,onClose:C.a.func,relativePosition:C.a.shape({left:C.a.number}),customPosition:C.a.shape({top:C.a.number,left:C.a.number,positionClass:C.a.oneOf(["top","right","bottom","left"])})};t.a=X},"./components/popover/style.scss":function(e,t,o){}}]);